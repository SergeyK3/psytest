#!/usr/bin/env python3
"""
–¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ —Å –Ω–æ–≤–æ–π –∫—Ä—É–≥–æ–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º–æ–π DISC
"""

import sys
from pathlib import Path
from datetime import datetime

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞
sys.path.append('.')

from enhanced_pdf_report_v2 import EnhancedPDFReportV2

def test_full_report_with_disc_pie():
    """–¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ —Å –∫—Ä—É–≥–æ–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º–æ–π DISC"""
    
    print("üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ —Å –∫—Ä—É–≥–æ–≤–æ–π DISC –¥–∏–∞–≥—Ä–∞–º–º–æ–π...")
    
    # –°–æ–∑–¥–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤
    pdf_generator = EnhancedPDFReportV2()
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    test_data = {
        'participant_name': '–¢–µ—Å—Ç –î–∏–∞–≥—Ä–∞–º–º—ã DISC',
        'test_date': datetime.now().strftime("%Y-%m-%d"),
        
        'paei_scores': {
            '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å': 7,
            '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä': 4,
            '–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å': 8,
            '–ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä': 5
        },
        
        'disc_scores': {
            'D (–î–æ–º–∏–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å)': 8,
            'I (–í–ª–∏—è–Ω–∏–µ)': 5,
            'S (–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å)': 3,
            'C (–¢–æ—á–Ω–æ—Å—Ç—å)': 6
        },
        
        'hexaco_scores': {
            '–ß–µ—Å—Ç–Ω–æ—Å—Ç—å-–°–º–∏—Ä–µ–Ω–∏–µ': 4,
            '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å': 3,
            '–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è': 5,
            '–ü—Ä–∏—è—Ç–Ω–æ—Å—Ç—å': 4,
            '–°–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å': 5,
            '–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–ø—ã—Ç—É': 3
        },
        
        'soft_skills_scores': {
            '–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è': 8,
            '–õ–∏–¥–µ—Ä—Å—Ç–≤–æ': 7,
            '–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞': 6,
            '–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å': 9,
            '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ': 5
        },
        
        'ai_interpretations': {
            'overall': '–û–±—â–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å –Ω–æ–≤–æ–π –∫—Ä—É–≥–æ–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º–æ–π DISC',
            'disc': 'DISC: –î–æ–º–∏–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å 36.4%, –í–ª–∏—è–Ω–∏–µ 22.7%, –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å 13.6%, –¢–æ—á–Ω–æ—Å—Ç—å 27.3%',
            'paei': 'PAEI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è',
            'hexaco': 'HEXACO –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è', 
            'soft_skills': 'Soft skills –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è'
        },
        
        'out_path': Path("test_disc_pie_report.pdf")
    }
    
    try:
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
        print("üìÑ –°–æ–∑–¥–∞–Ω–∏–µ PDF –æ—Ç—á–µ—Ç–∞...")
        pdf_path = pdf_generator.generate_enhanced_report(**test_data)
        
        if pdf_path and pdf_path.exists():
            file_size = pdf_path.stat().st_size / 1024  # KB
            print(f"‚úÖ –û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: {pdf_path}")
            print(f"üì¶ –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {file_size:.1f} KB")
            print(f"üéØ DISC –¥–∏–∞–≥—Ä–∞–º–º–∞: –ö–†–£–ì–û–í–ê–Ø (–±–µ–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏)")
            print(f"üìä –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—ã—Ä—ã–µ –±–∞–ª–ª—ã –∏ –ø—Ä–æ—Ü–µ–Ω—Ç—ã")
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–æ–∑–¥–∞–Ω—ã –≤—Å–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
            charts_dir = Path("temp_charts")
            disc_pie = charts_dir / "disc_pie.png"
            
            if disc_pie.exists():
                print(f"‚úÖ –ö—Ä—É–≥–æ–≤–∞—è DISC –¥–∏–∞–≥—Ä–∞–º–º–∞ —Å–æ–∑–¥–∞–Ω–∞: {disc_pie}")
            else:
                print(f"‚ùå –ö—Ä—É–≥–æ–≤–∞—è DISC –¥–∏–∞–≥—Ä–∞–º–º–∞ –ù–ï –Ω–∞–π–¥–µ–Ω–∞: {disc_pie}")
                
            return True
        else:
            print("‚ùå –û—à–∏–±–∫–∞: PDF —Ñ–∞–π–ª –Ω–µ —Å–æ–∑–¥–∞–Ω")
            return False
            
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ—Ç—á–µ—Ç–∞: {e}")
        import traceback
        traceback.print_exc()
        return False

if __name__ == "__main__":
    success = test_full_report_with_disc_pie()
    if success:
        print("\nüéâ –¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω! –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ DISC —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.")
    else:
        print("\n‚ùå –¢–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω!")