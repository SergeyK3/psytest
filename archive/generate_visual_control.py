#!/usr/bin/env python3
"""
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF –æ—Ç—á–µ—Ç–∞ —Å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º–æ–π PAEI –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è
"""

from enhanced_pdf_report_v2 import EnhancedPDFReportV2
from pathlib import Path
from datetime import datetime

def generate_visual_control_report():
    """–°–æ–∑–¥–∞–µ—Ç PDF –æ—Ç—á–µ—Ç –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã PAEI"""
    
    print('üöÄ –°–æ–∑–¥–∞–Ω–∏–µ PDF –æ—Ç—á–µ—Ç–∞ —Å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º–æ–π PAEI –¥–ª—è Google Drive')
    print('=' * 70)

    # –°–æ–∑–¥–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
    generator = EnhancedPDFReportV2()

    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ PAEI –∫–∞–∫ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
    test_data = {
        'participant_name': '–í–∏–∑—É–∞–ª—å–Ω—ã–π –ö–æ–Ω—Ç—Ä–æ–ª—å PAEI',
        'test_date': datetime.now().strftime('%d.%m.%Y'),
        'paei_scores': {'P': 8, 'A': 5, 'E': 7, 'I': 4},  # –ö–∞–∫ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
        'disc_scores': {'D': 6, 'I': 5, 'S': 4, 'C': 7},
        'hexaco_scores': {'H': 3.5, 'E': 3.2, 'X': 4.1, 'A': 3.8, 'C': 4.0, 'O': 3.6},
        'soft_skills_scores': {
            '–õ–∏–¥–µ—Ä—Å—Ç–≤–æ': 7, 
            '–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è': 8, 
            '–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å': 6, 
            '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ': 7, 
            '–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å': 6
        },
        'ai_interpretations': {
            'overall': '–ü—Ä–æ—Ñ–∏–ª—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–∏–ª—å–Ω—ã–µ —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Å –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–º —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.',
            'paei': '–Ø—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π —Ç–∏–ø –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—è. –í—ã—Å–æ–∫–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.',
            'disc': '–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Å —É–º–µ—Ä–µ–Ω–Ω—ã–º –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –≤—ã—Å–æ–∫–æ–π –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é.',
            'hexaco': '–°—Ç–∞–±–∏–ª—å–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å —Å —Ö–æ—Ä–æ—à–∏–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç–∏.',
            'soft_skills': '–°–∏–ª—å–Ω—ã–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ –∏ –ª–∏–¥–µ—Ä—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª.'
        }
    }

    # –ü—É—Ç—å –¥–ª—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
    output_path = Path('temp_charts') / f'paei_combined_visual_control_{timestamp}.pdf'

    try:
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
        pdf_path, gdrive_link = generator.generate_enhanced_report_with_gdrive(
            out_path=output_path,
            **test_data
        )
        
        print(f'‚úÖ PDF —Å–æ–∑–¥–∞–Ω: {pdf_path}')
        print(f'üìÅ –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {pdf_path.stat().st_size / 1024:.1f} KB')
        
        if gdrive_link:
            print(f'üîó Google Drive —Å—Å—ã–ª–∫–∞: {gdrive_link}')
        else:
            print('‚ö†Ô∏è  Google Drive: –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å, —Ñ–∞–π–ª –æ—Å—Ç–∞–ª—Å—è –ª–æ–∫–∞–ª—å–Ω–æ')
            
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
        paei_combined = Path('temp_charts/paei_combined.png')
        if paei_combined.exists():
            print(f'üìä –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ PAEI: {paei_combined.stat().st_size / 1024:.1f} KB')
        
        print('\nüéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:')
        print(f'  üìÑ PDF —Ñ–∞–π–ª: {pdf_path}')
        if gdrive_link:
            print(f'  üîó Google Drive: {gdrive_link}')
        print('  üìä –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏: –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ PAEI (—Å—Ç–æ–ª–±–∏–∫–æ–≤–∞—è + –∫—Ä—É–≥–æ–≤–∞—è)')
        
        return pdf_path, gdrive_link
        
    except Exception as e:
        print(f'‚ùå –û—à–∏–±–∫–∞: {e}')
        import traceback
        traceback.print_exc()
        return None, None

if __name__ == "__main__":
    generate_visual_control_report()