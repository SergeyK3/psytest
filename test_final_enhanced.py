#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–§–ò–ù–ê–õ–¨–ù–´–ô –¢–ï–°–¢ ENHANCED PDF V4.0 + –ù–£–ú–ï–†–ê–¶–ò–Ø + GOOGLE DRIVE
–ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü –∏ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ Google –ø–∞–ø–∫—É
"""

from pathlib import Path
from datetime import datetime
from enhanced_pdf_report_v2 import EnhancedPDFReportV2

def final_test_enhanced_pdf():
    """
    –§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç enhanced PDF —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π –∏ Google Drive
    """
    print("üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –¢–ï–°–¢ ENHANCED PDF V4.0")
    print("=" * 60)
    print("‚úÖ –ù—É–º–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –≤–µ—Ä—Ö–Ω–µ–º –ø—Ä–∞–≤–æ–º —É–≥–ª—É")
    print("‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Google Drive —Å –º–µ—Å—è—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π")
    print("‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã")
    print("‚úÖ –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç ~900KB")
    print()
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
    generator = EnhancedPDFReportV2()
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    participant_name = "–§–∏–Ω–∞–ª—å–Ω—ã–π –¢–µ—Å—Ç Enhanced V4.0"
    test_date = datetime.now().strftime("%Y-%m-%d")
    
    paei_scores = {"P": 8, "A": 6, "E": 9, "I": 7}
    disc_scores = {"D": 7, "I": 8, "S": 5, "C": 6}
    hexaco_scores = {"H": 4, "E": 3, "X": 5, "A": 4, "C": 5, "O": 4}
    
    soft_skills_scores = {
        "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ": 8, "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 9, "–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 7, "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞": 6,
        "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å": 8, "–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞": 9, "–≠–º–ø–∞—Ç–∏—è": 8, 
        "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ": 7, "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º": 6, "–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º": 8
    }
    
    # –ü–æ–ª–Ω—ã–µ AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏
    ai_interpretations = {
        "paei": """
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è PAEI –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —è—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—è (E=9) 
        —Å —Å–∏–ª—å–Ω—ã–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞–º–∏ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è (P=8). –≠—Ç–æ —Å–æ—á–µ—Ç–∞–Ω–∏–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω—É—é 
        —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏–¥–µ–∏ –∏ –≤–∏–¥–µ—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ 
        –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã, –Ω–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –∏—Ö –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ. –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –æ–±–ª–∞–¥–∞–µ—Ç 
        —Ä–µ–¥–∫–∏–º –±–∞–ª–∞–Ω—Å–æ–º –º–µ–∂–¥—É –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ 
        —Ü–µ–Ω–Ω—ã–º –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –≤ –ø–µ—Ä–∏–æ–¥—ã —Ä–æ—Å—Ç–∞ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏.
        """,
        "disc": """
        –ü—Ä–æ—Ñ–∏–ª—å DISC –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∏–ª—è –í–ª–∏—è–Ω–∏—è (I=8) –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å –≤—ã—Å–æ–∫–∏–º 
        –î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º (D=7). –î–∞–Ω–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–∞ –¥–ª—è –ø—Ä–∏—Ä–æ–∂–¥–µ–Ω–Ω—ã—Ö –ª–∏–¥–µ—Ä–æ–≤, 
        —Å–ø–æ—Å–æ–±–Ω—ã—Ö –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è. –í—ã—Å–æ–∫–æ–µ –í–ª–∏—è–Ω–∏–µ 
        —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã—Ö –Ω–∞–≤—ã–∫–∞—Ö, —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —É–±–µ–∂–¥–∞—Ç—å –∏ 
        –º–æ—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏—Ö. –≠—Ç–æ –¥–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å—é, —á—Ç–æ 
        –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç—å –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –∏ –∫–æ–º–∞–Ω–¥–∞–º–∏.
        """,
        "hexaco": """
        –õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å HEXACO –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –æ—Å–Ω–æ–≤–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–Ω—ã—Ö 
        —Ñ–∞–∫—Ç–æ—Ä–æ–≤, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –∑—Ä–µ–ª–æ—Å—Ç–∏ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏. 
        –£–º–µ—Ä–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –≤—Å–µ–º —à–∫–∞–ª–∞–º —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –≥–∏–±–∫–æ—Å—Ç—å –≤ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å 
        –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Å–∏—Ç—É–∞—Ü–∏—è–º –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º. –≠—Ç–æ –ø—Ä–æ—Ñ–∏–ª—å —á–µ–ª–æ–≤–µ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π 
        –º–æ–∂–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö.
        """
    }
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    safe_name = "".join(c for c in participant_name if c.isalnum() or c in (' ', '-', '_')).rstrip()
    safe_name = safe_name.replace(' ', '_')
    filename = f"final_enhanced_{safe_name}_{timestamp}.pdf"
    out_path = Path(filename)
    
    print(f"üìÑ –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞: {filename}")
    print(f"üë§ –£—á–∞—Å—Ç–Ω–∏–∫: {participant_name}")
    print(f"üìÖ –î–∞—Ç–∞: {test_date}")
    print()
    
    try:
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å Google Drive –∏ –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π
        pdf_path, gdrive_link = generator.generate_enhanced_report_with_gdrive(
            participant_name=participant_name,
            test_date=test_date,
            paei_scores=paei_scores,
            disc_scores=disc_scores,
            hexaco_scores=hexaco_scores,
            soft_skills_scores=soft_skills_scores,
            ai_interpretations=ai_interpretations,
            out_path=out_path,
            upload_to_gdrive=True
        )
        
        print("üéâ –§–ò–ù–ê–õ–¨–ù–´–ô ENHANCED PDF –°–û–ó–î–ê–ù –£–°–ü–ï–®–ù–û!")
        print(f"üìÑ –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª: {pdf_path}")
        
        if gdrive_link:
            print(f"‚òÅÔ∏è Google Drive: {gdrive_link}")
            print("üéØ –û—Ç—á–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –º–µ—Å—è—á–Ω—É—é –ø–∞–ø–∫—É Google Drive!")
        else:
            print("‚ö†Ô∏è Google Drive: –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞
        if pdf_path.exists():
            size = pdf_path.stat().st_size
            size_kb = size / 1024
            print(f"üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {size} –±–∞–π—Ç ({size_kb:.1f} KB)")
        
        print()
        print("üéâ –§–ò–ù–ê–õ–¨–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!")
        print("üìã –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:")
        print("   ‚úÖ PDF —Å–æ–∑–¥–∞–Ω –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Å–µ–∫—Ü–∏–∏")
        print("   ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ä–∞–¥–∞—Ä–Ω—ã–µ –∏ —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã")
        print("   ‚úÖ –ù—É–º–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –≤–µ—Ä—Ö–Ω–µ–º –ø—Ä–∞–≤–æ–º —É–≥–ª—É")
        print("   ‚úÖ Google Drive –∑–∞–≥—Ä—É–∑–∫–∞ —Å –º–µ—Å—è—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π")
        print("   ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã (Arial —à—Ä–∏—Ñ—Ç—ã)")
        print("   ‚úÖ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ")
        print()
        print("üéØ Enhanced PDF Report V4.0 –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!")
        
        return pdf_path, gdrive_link
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞: {e}")
        import traceback
        traceback.print_exc()
        return None, None

if __name__ == "__main__":
    final_test_enhanced_pdf()