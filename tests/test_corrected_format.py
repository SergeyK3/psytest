#!/usr/bin/env python3
"""
–§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–π —Å–æ–≥–ª–∞—Å–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É general_system_res.txt
–†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ API –∫–ª—é—á–∞, –∏—Å–ø–æ–ª—å–∑—É—è —à–∞–±–ª–æ–Ω—ã –∏–∑ –ø—Ä–æ–º–ø—Ç–∞
"""

from pathlib import Path
import datetime

def generate_ai_interpretations_from_prompt(paei_scores, disc_scores, hexaco_scores, soft_skills_scores):
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ —Ñ–æ—Ä–º–∞—Ç—É –∏–∑ general_system_res.txt
    """
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    paei_max = max(paei_scores, key=paei_scores.get)
    paei_roles = {'P': '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å', 'A': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', 'E': '–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å', 'I': '–ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä'}
    dominant_paei_role = paei_roles[paei_max]
    
    disc_max = max(disc_scores, key=disc_scores.get)
    disc_styles = {'D': '–î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ', 'I': '–í–ª–∏—è–Ω–∏–µ', 'S': '–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å', 'C': '–¢–æ—á–Ω–æ—Å—Ç—å'}
    dominant_disc_style = disc_styles[disc_max]
    
    hexaco_max = max(hexaco_scores, key=hexaco_scores.get)
    
    soft_max = max(soft_skills_scores, key=soft_skills_scores.get)
    
    # –ù–∞—Ö–æ–¥–∏–º —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è
    weak_paei = [paei_roles[role] for role, score in paei_scores.items() if score < 6]
    weak_skills = [skill for skill, score in soft_skills_scores.items() if score < 8.0]
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É
    ai_interpretations = {
        'paei': f'''–ü—Ä–µ–æ–±–ª–∞–¥–∞—é—â–∏–π –ø—Ä–æ—Ñ–∏–ª—å {dominant_paei_role} ({paei_scores[paei_max]} –±–∞–ª–ª–æ–≤) —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —Ä–∞–±–æ—Ç–µ.

–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–û–ú–£ –†–ê–ó–í–ò–¢–ò–Æ:

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω:
    ‚Ä¢ (PAEI): –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ—Ñ–∏–ª—é {dominant_paei_role}
    ‚Ä¢ (Soft Skills): –†–∞–∑–≤–∏–≤–∞—Ç—å {soft_max} —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
    ‚Ä¢ (DISC): –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å {dominant_disc_style} –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏

2. –û–±–ª–∞—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:
    ‚Ä¢ (PAEI): –†–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –º–µ–Ω–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–º–∏ —Ä–æ–ª—è–º–∏ {', '.join(weak_paei) if weak_paei else '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'}
    ‚Ä¢ (Soft Skills): –†–∞–∑–≤–∏–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ soft skills –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏ {weak_skills} [–ø–æ–∏—Å–∫ –∫—É—Ä—Å–æ–≤ –≤ Google]
    ‚Ä¢ (DISC): –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏

3. –ö–∞—Ä—å–µ—Ä–Ω—ã–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã:
    ‚Ä¢ (PAEI): –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∏—Ü–∏–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –∫–∞—á–µ—Å—Ç–≤ {dominant_paei_role}
    ‚Ä¢ (HEXACO): –ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–≤–∏—Ç–∏–µ —Å —É—á–µ—Ç–æ–º –ª–∏—á–Ω–æ—Å—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è HEXACO
    ‚Ä¢ (DISC): –í—ã—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É —Å —É—á–µ—Ç–æ–º –∫–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã—Ö —Ä–æ–ª–µ–π –ø–æ DISC''',
        
        'soft_skills': f'–ù–∞–∏–±–æ–ª–µ–µ —Ä–∞–∑–≤–∏—Ç—ã–π –Ω–∞–≤—ã–∫ {soft_max} ({soft_skills_scores[soft_max]} –±–∞–ª–ª–æ–≤) —è–≤–ª—è–µ—Ç—Å—è —Å–∏–ª—å–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–æ–π –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è.',
        
        'hexaco': f'–î–æ–º–∏–Ω–∏—Ä—É—é—â–∞—è —á–µ—Ä—Ç–∞ –ª–∏—á–Ω–æ—Å—Ç–∏ –ø–æ –º–æ–¥–µ–ª–∏ HEXACO –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –ø–æ–≤–µ–¥–µ–Ω–∏—è.',
        
        'disc': f'–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å {dominant_disc_style} ({disc_scores[disc_max]} –±–∞–ª–ª–æ–≤) –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é –∑–∞–¥–∞—á –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é –≤ –∫–æ–º–∞–Ω–¥–µ.',
        
        'general': '''–û–±—â–∏–π –ø–æ—Ä—Ç—Ä–µ—Ç –ª–∏—á–Ω–æ—Å—Ç–∏:
–≠—Ç–æ—Ç —á–µ–ª–æ–≤–µ–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Å –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–º–∏ —Å–∏–ª—å–Ω—ã–º–∏ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏ –∏ –æ–±–ª–∞—Å—Ç—è–º–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã —Å —É—á–µ—Ç–æ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–∏–∫ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–∏ –∏ –≤–∫–ª—é—á–∞—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞.'''
    }
    
    return ai_interpretations

def test_corrected_format_pdf():
    """–°–æ–∑–¥–∞–µ—Ç PDF —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º —Å–æ–≥–ª–∞—Å–Ω–æ general_system_res.txt"""
    
    print("üéØ –ì–ï–ù–ï–†–ê–¶–ò–Ø PDF –° –ü–†–ê–í–ò–õ–¨–ù–´–ú –§–û–†–ú–ê–¢–û–ú")
    print("=" * 50)
    print()
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    test_data = {
        'paei_scores': {'P': 8, 'A': 5, 'E': 7, 'I': 6},
        'disc_scores': {'D': 7, 'I': 5, 'S': 3, 'C': 4},
        'hexaco_scores': {'H': 4, 'E': 3, 'X': 5, 'A': 4, 'C': 5, 'O': 3},
        'soft_skills_scores': {
            '–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è': 8.5,
            '–õ–∏–¥–µ—Ä—Å—Ç–≤–æ': 9.0,
            '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ': 6.5,
            '–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å': 7.2,
            '–†–∞–±–æ—Ç–∞ –≤ –∫–æ–º–∞–Ω–¥–µ': 8.8,
            '–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å': 8.1,
            '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç': 9.2,
            '–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º': 7.8,
            '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º': 8.5,
            '–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –Ω–∞–≤—ã–∫–∏': 7.0
        }
    }
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É –ø—Ä–æ–º–ø—Ç—É
    print("üß† –ì–µ–Ω–µ—Ä–∞—Ü–∏—è AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–π —Å–æ–≥–ª–∞—Å–Ω–æ general_system_res.txt...")
    ai_interpretations = generate_ai_interpretations_from_prompt(
        test_data['paei_scores'],
        test_data['disc_scores'], 
        test_data['hexaco_scores'],
        test_data['soft_skills_scores']
    )
    
    print("‚úÖ –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã —Å –Ω–æ–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º!")
    print()
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
    print("üîç –ö–õ–Æ–ß–ï–í–´–ï –≠–õ–ï–ú–ï–ù–¢–´ –ù–û–í–û–ì–û –§–û–†–ú–ê–¢–ê:")
    print("    ‚úÖ –ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã –º–µ—Ç–æ–¥–æ–≤: (PAEI):, (Soft Skills):, (DISC):, (HEXACO):")
    print("    ‚úÖ –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —Å–∫–æ–±–∫–∏: [–ø–æ–∏—Å–∫ –∫—É—Ä—Å–æ–≤ –≤ Google]")
    print("    ‚úÖ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è")
    print("    ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏")
    print()
    
    # –°–æ–∑–¥–∞–µ–º PDF
    from enhanced_pdf_report_v2 import EnhancedPDFReportV2
    generator = EnhancedPDFReportV2()
    timestamp = datetime.datetime.now().strftime('%Y%m%d_%H%M%S')
    output_path = Path(f'corrected_format_{timestamp}.pdf')
    
    print(f"üìÑ –°–æ–∑–¥–∞–Ω–∏–µ PDF: {output_path}")
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –≤ Google Drive
    drive_url = generator.generate_enhanced_report_with_gdrive(
        '–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –§–æ—Ä–º–∞—Ç –°–æ–≥–ª–∞—Å–Ω–æ –ü—Ä–æ–º–ø—Ç—É',
        '2025-10-04',
        test_data['paei_scores'],
        test_data['disc_scores'], 
        test_data['hexaco_scores'],
        test_data['soft_skills_scores'],
        ai_interpretations,
        output_path
    )
    
    print("‚úÖ PDF —Å–æ–∑–¥–∞–Ω —Å –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ú —Ñ–æ—Ä–º–∞—Ç–æ–º!")
    print()
    
    if isinstance(drive_url, tuple):
        print(f"üîó Google Drive: {drive_url[1]}")
    else:
        print(f"üîó Google Drive: {drive_url}")
    
    print(f"üìÅ –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª: {output_path}")
    print()
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
    print("üìù –§–†–ê–ì–ú–ï–ù–¢ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô (–Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç):")
    recommendations = ai_interpretations['paei'].split('–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–û–ú–£ –†–ê–ó–í–ò–¢–ò–Æ:')[1][:400]
    print(recommendations[:400] + "...")
    print()
    print("üéâ –ì–û–¢–û–í–û! –¢–µ–ø–µ—Ä—å PDF –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∏–∑ general_system_res.txt")

if __name__ == "__main__":
    test_corrected_format_pdf()