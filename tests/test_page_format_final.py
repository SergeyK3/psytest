#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–¢–µ—Å—Ç —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –Ω—É–º–µ—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü: "–°—Ç—Ä. X –∏–∑ N"
"""

import sys
import os
from pathlib import Path
from enhanced_pdf_report_v2 import EnhancedPDFReportV2
from oauth_google_drive import upload_to_google_drive_oauth

def test_enhanced_numbering():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω—É–º–µ—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü"""
    
    print("üî¢ –¢–ï–°–¢ –£–õ–£–ß–®–ï–ù–ù–û–ô –ù–£–ú–ï–†–ê–¶–ò–ò –°–¢–†–ê–ù–ò–¶")
    print("=" * 60)
    print("üéØ –§–æ—Ä–º–∞—Ç: '–°—Ç—Ä. X –∏–∑ N'")
    print("üì§ –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Google Drive –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è")
    print()
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    test_participant = "–¢–ï–°–¢ –§–û–†–ú–ê–¢–ê –ù–£–ú–ï–†–ê–¶–ò–ò"
    test_scores = {
        'paei': {'P': 85, 'A': 75, 'E': 90, 'I': 70},
        'disc': {'D': 80, 'I': 85, 'S': 70, 'C': 75},
        'hexaco': {
            '–ß–µ—Å—Ç–Ω–æ—Å—Ç—å-–°–∫—Ä–æ–º–Ω–æ—Å—Ç—å': 82,
            '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å': 68, 
            '–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è': 90,
            '–î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å': 85,
            '–î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å': 88,
            '–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–ø—ã—Ç—É': 92
        },
        'soft_skills': {
            '–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è': 88,
            '–õ–∏–¥–µ—Ä—Å—Ç–≤–æ': 85,
            '–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞': 90,
            '–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å': 82,
            '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ': 87,
            '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º': 83,
            '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç': 86,
            '–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å': 89
        }
    }
    
    # –°–æ–∑–¥–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–∞
    generator = EnhancedPDFReportV2()
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
    print(f"üìÑ –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π...")
    
    # –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
    from datetime import datetime
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_path = Path(f"enhanced_numbering_{timestamp}.pdf")
    
    # –ü—Ä–æ—Å—Ç—ã–µ AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∞
    ai_interpretations = {
        'paei': '–¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è PAEI –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω—É–º–µ—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü.',
        'disc': '–¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è DISC –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω—É–º–µ—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü.',
        'hexaco': '–¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è HEXACO –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω—É–º–µ—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü.',
        'soft_skills': '–¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è Soft Skills –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω—É–º–µ—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü.'
    }
    
    pdf_path = generator.generate_enhanced_report(
        participant_name=test_participant,
        test_date="2025-10-05",
        paei_scores=test_scores['paei'],
        disc_scores=test_scores['disc'],
        hexaco_scores=test_scores['hexaco'],
        soft_skills_scores=test_scores['soft_skills'],
        ai_interpretations=ai_interpretations,
        out_path=output_path
    )
    
    # –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
    file_size = os.path.getsize(pdf_path)
    print(f"üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {file_size} –±–∞–π—Ç ({file_size/1024:.1f} KB)")
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –≤ Google Drive
    print("üì§ –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Google Drive...")
    try:
        drive_link = upload_to_google_drive_oauth(pdf_path, "–¢–ï–°–¢ –§–û–†–ú–ê–¢–ê –ù–£–ú–ï–†–ê–¶–ò–ò")
        if drive_link:
            print("‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ Google Drive!")
            print(f"üîó –°—Å—ã–ª–∫–∞: {drive_link}")
        else:
            print("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Google Drive")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ Google Drive: {e}")
    
    print()
    print("‚úÖ –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù!")
    print(f"üìÑ –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª: {pdf_path}")
    if 'drive_link' in locals():
        print(f"üîó Google Drive: {drive_link}")
    print()
    print("üëÅÔ∏è –ß–¢–û –ü–†–û–í–ï–†–ò–¢–¨:")
    print("   1. –û—Ç–∫—Ä–æ–π—Ç–µ PDF —Ñ–∞–π–ª")
    print("   2. –ù–∞ –ö–ê–ñ–î–û–ô —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤ –≤–µ—Ä—Ö–Ω–µ–º –ø—Ä–∞–≤–æ–º —É–≥–ª—É")
    print("   3. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: '–°—Ç—Ä. 1 –∏–∑ N', '–°—Ç—Ä. 2 –∏–∑ N', –∏ —Ç.–¥.")
    print("   4. –ì–¥–µ N - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü")
    print("   5. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ü–∏—Ñ—Ä–∞ –æ–±—â–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –æ–¥–∏–Ω–∞–∫–æ–≤–∞ –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö")

if __name__ == "__main__":
    test_enhanced_numbering()