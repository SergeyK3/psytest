#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ PDF –æ—Ç—á–µ—Ç–∞ v4.0
–¢–µ—Å—Ç: –Ω–æ–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ + —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç + –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
"""

from pathlib import Path
from enhanced_pdf_report_v2 import EnhancedPDFReportV2
from test_scenarios import TEST_SCENARIOS

def test_final_version():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏"""
    
    output_dir = Path("test_final_version")
    output_dir.mkdir(exist_ok=True)
    
    print("üéØ –§–ò–ù–ê–õ–¨–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï PDF v4.0")
    print("=" * 50)
    print("üî• –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:")
    print("   ‚úÖ –ó–∞–≥–æ–ª–æ–≤–æ–∫: '–û–¶–ï–ù–ö–ê –ö–û–ú–ê–ù–î–ù–´–• –ù–ê–í–´–ö–û–í'")
    print("   ‚úÖ –£–±—Ä–∞–Ω–∞ —Å–ª–∏–ø—à–∞—è—Å—è —Å—Ç—Ä–æ–∫–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã")
    print("   ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω —Ä–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞: 10pt ‚Üí 11pt")
    print("   ‚úÖ –£–ª—É—á—à–µ–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª: 12pt ‚Üí 14pt")
    print("   ‚úÖ –î–∏–∞–≥—Ä–∞–º–º—ã: 120mm ‚Üí 100mm (–±–∞–ª–∞–Ω—Å)")
    print("=" * 50)
    
    pdf_generator = EnhancedPDFReportV2(template_dir=output_dir / "temp_charts")
    
    # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å —Ç–≤–æ—Ä—á–µ—Å–∫–∏–º –∏–Ω–Ω–æ–≤–∞—Ç–æ—Ä–æ–º
    scenario = TEST_SCENARIOS["creative_innovator"]
    participant_name = "–°–º–∏—Ä–Ω–æ–≤–∞ –ê–Ω–Ω–∞"
    
    print(f"\nüìä –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –¥–ª—è: {participant_name}")
    print(f"üé® –ü—Ä–æ—Ñ–∏–ª—å: {scenario['name']}")
    
    # Soft skills —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ—Ñ–∏–ª—é
    soft_skills = {
        "–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ": 95,
        "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å": 88,
        "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 82,
        "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ": 78,
        "–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ": 70,
        "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞": 65
    }
    
    # –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ
    interpretations = {
        "paei": """–£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ä–æ–ª–∏ –ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—è (E = 82 –±–∞–ª–ª–∞) 
                   —Å –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é –∫ –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º, —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–º—É –º—ã—à–ª–µ–Ω–∏—é –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–¥–µ–π. 
                   –î–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–∏—Ä–æ–¥–Ω—É—é —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ–º—É –ø–æ–¥—Ö–æ–¥—É –≤ —Ä–µ—à–µ–Ω–∏–∏ –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á.""",
        "disc": """–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ–º I-—Ç–∏–ø–∞ (–í–ª–∏—è–Ω–∏–µ = 85 –±–∞–ª–ª–æ–≤), —á—Ç–æ 
                   —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –æ –≤—ã—Å–æ–∫–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏, —ç–Ω—Ç—É–∑–∏–∞–∑–º–µ –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö. 
                   –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ç–≤–æ—Ä—á–µ—Å–∫–æ–≥–æ —Å–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏—è –∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç—ã.""",
        "hexaco": """–õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –û—Ç–∫—Ä—ã—Ç–æ—Å—Ç–∏ –æ–ø—ã—Ç—É (O = 90 –±–∞–ª–ª–æ–≤), —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç 
                     –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –Ω–æ–≤—ã–º –∏–¥–µ—è–º. –î–∞–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–µ–ª–∞—é—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ 
                     —Ü–µ–Ω–Ω—ã–º –¥–ª—è –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π."""
    }
    
    output_path = output_dir / f"final_report_{participant_name.lower().replace(' ', '_')}.pdf"
    
    try:
        pdf_generator.generate_enhanced_report(
            participant_name=participant_name,
            test_date="2025-10-02",
            paei_scores=scenario["paei_scores"],
            disc_scores=scenario["disc_scores"],
            hexaco_scores=scenario["hexaco_scores"],
            soft_skills_scores=soft_skills,
            ai_interpretations=interpretations,
            out_path=output_path
        )
        
        if output_path.exists():
            size_kb = output_path.stat().st_size / 1024
            print(f"\nüéâ –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢ –°–û–ó–î–ê–ù!")
            print(f"üìÅ –§–∞–π–ª: {output_path.name}")
            print(f"üìä –†–∞–∑–º–µ—Ä: {size_kb:.1f} KB")
            print(f"üñºÔ∏è  –î–∏–∞–≥—Ä–∞–º–º—ã: 4 –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ (100mm)")
            
            # –°–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
            print(f"\nüìã –°–í–û–î–ö–ê –§–ò–ù–ê–õ–¨–ù–´–• –ò–ó–ú–ï–ù–ï–ù–ò–ô:")
            print(f"   üéØ –ó–∞–≥–æ–ª–æ–≤–æ–∫: '–û–¶–ï–ù–ö–ê –ö–û–ú–ê–ù–î–ù–´–• –ù–ê–í–´–ö–û–í'")
            print(f"   üìÑ –°—Ç—Ä—É–∫—Ç—É—Ä–∞: –ß–∏—Å—Ç–∞—è —Ç–∞–±–ª–∏—Ü–∞ –±–µ–∑ –¥—É–±–ª–µ–π")
            print(f"   üìù –¢–µ–∫—Å—Ç: 11pt (–±—ã–ª–æ 10pt) —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 14pt")
            print(f"   üìä –î–∏–∞–≥—Ä–∞–º–º—ã: 100mm (–±–∞–ª–∞–Ω—Å —Å —Ç–µ–∫—Å—Ç–æ–º)")
            print(f"   üé® –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å: –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–∞")
            
            # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π
            print(f"\nüìà –≠–í–û–õ–Æ–¶–ò–Ø –í–ï–†–°–ò–ô:")
            print(f"   v1.0: –ë–∞–∑–æ–≤—ã–π PDF (~90KB)")
            print(f"   v2.0: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã (~620KB)")
            print(f"   v3.0: –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–µ (~610KB)")
            print(f"   v4.0: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω ({size_kb:.0f}KB)")
            
        print(f"\nüìÇ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª: {output_path}")
        print("üéØ –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!")
        
    except Exception as e:
        print(f"‚ùå –û–®–ò–ë–ö–ê: {e}")
        import traceback
        traceback.print_exc()

if __name__ == "__main__":
    test_final_version()