#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–¢–ï–°–¢ –ù–£–ú–ï–†–ê–¶–ò–ò –°–¢–†–ê–ù–ò–¶ –í ENHANCED PDF
–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –≤–µ—Ä—Ö–Ω–∏–π –ø—Ä–∞–≤—ã–π —É–≥–æ–ª
"""

from pathlib import Path
from datetime import datetime
from enhanced_pdf_report_v2 import EnhancedPDFReportV2

def test_page_numbering():
    """
    –¢–µ—Å—Ç –Ω—É–º–µ—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ enhanced –æ—Ç—á–µ—Ç–µ
    """
    print("üî¢ –¢–ï–°–¢ –ù–£–ú–ï–†–ê–¶–ò–ò –°–¢–†–ê–ù–ò–¶ –í ENHANCED PDF")
    print("=" * 60)
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
    generator = EnhancedPDFReportV2()
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞
    participant_name = "–¢–µ—Å—Ç –ù—É–º–µ—Ä–∞—Ü–∏–∏ –°—Ç—Ä–∞–Ω–∏—Ü"
    test_date = datetime.now().strftime("%Y-%m-%d")
    
    paei_scores = {"P": 8, "A": 6, "E": 9, "I": 7}
    disc_scores = {"D": 7, "I": 8, "S": 5, "C": 6}
    hexaco_scores = {"H": 4, "E": 3, "X": 5, "A": 4, "C": 5, "O": 4}
    
    soft_skills_scores = {
        "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ": 8, "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 9, "–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 7, "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞": 6,
        "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å": 8, "–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞": 9, "–≠–º–ø–∞—Ç–∏—è": 8, 
        "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ": 7, "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º": 6, "–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º": 8
    }
    
    # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ–ª—å—à–µ —Å—Ç—Ä–∞–Ω–∏—Ü
    ai_interpretations = {
        "paei": """
        –ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ PAEI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ —Ä–æ–ª–∏ –ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—è (E=9), 
        —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —è—Ä–∫–∏–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –≤—ã—Å–æ–∫–æ–π –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏, —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –º—ã—à–ª–µ–Ω–∏—è –∏ 
        –≤—ã–¥–∞—é—â–µ–π—Å—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∫ –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º. –î–∞–Ω–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –æ —Ç–æ–º, —á—Ç–æ 
        —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –æ–±–ª–∞–¥–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é –≤–∏–¥–µ—Ç—å –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã —Ä–∞–∑–≤–∏—Ç–∏—è –±–∏–∑–Ω–µ—Å–∞, 
        –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∏–¥–µ–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —É—Å–ª–æ–≤–∏—è–º —Ä—ã–Ω–∫–∞.
        """,
        "disc": """
        –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ñ–∏–ª—è DISC –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –≤—ã—Å–æ–∫–æ–≥–æ –í–ª–∏—è–Ω–∏—è (I=8) 
        –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–≥–æ –î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (D=7), —á—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –¥–ª—è —Ö–∞—Ä–∏–∑–º–∞—Ç–∏—á–Ω—ã—Ö –ª–∏–¥–µ—Ä–æ–≤ –Ω–æ–≤–æ–≥–æ 
        –ø–æ–∫–æ–ª–µ–Ω–∏—è, —Å–ø–æ—Å–æ–±–Ω—ã—Ö –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –±—ã—Å—Ç—Ä—ã–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –Ω–æ –∏ 
        –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥—É –Ω–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –∞–º–±–∏—Ü–∏–æ–∑–Ω—ã—Ö —Ü–µ–ª–µ–π.
        """,
        "hexaco": """
        –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ª–∏—á–Ω–æ—Å—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è HEXACO –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ 
        —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ª–∏—á–Ω–æ—Å—Ç–∏ —Å —É–º–µ—Ä–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤—É –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤, 
        —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–æ–º –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –∑—Ä–µ–ª–æ—Å—Ç–∏ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏.
        """
    }
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    filename = f"test_page_numbering_{timestamp}.pdf"
    out_path = Path(filename)
    
    print(f"üìÑ –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π: {filename}")
    print(f"üë§ –£—á–∞—Å—Ç–Ω–∏–∫: {participant_name}")
    print(f"üî¢ –û–∂–∏–¥–∞–µ–º—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: 3-5 (—Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π –≤ –≤–µ—Ä—Ö–Ω–µ–º –ø—Ä–∞–≤–æ–º —É–≥–ª—É)")
    print()
    
    try:
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü
        pdf_path = generator.generate_enhanced_report(
            participant_name=participant_name,
            test_date=test_date,
            paei_scores=paei_scores,
            disc_scores=disc_scores,
            hexaco_scores=hexaco_scores,
            soft_skills_scores=soft_skills_scores,
            ai_interpretations=ai_interpretations,
            out_path=out_path
        )
        
        print("‚úÖ –û–¢–ß–ï–¢ –° –ù–£–ú–ï–†–ê–¶–ò–ï–ô –°–¢–†–ê–ù–ò–¶ –°–û–ó–î–ê–ù!")
        print(f"üìÑ –§–∞–π–ª: {pdf_path}")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞
        if pdf_path.exists():
            size = pdf_path.stat().st_size
            size_kb = size / 1024
            print(f"üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {size} –±–∞–π—Ç ({size_kb:.1f} KB)")
            
            if size > 500000:  # –ë–æ–ª—å—à–µ 500KB
                print("‚úÖ –û—Ç–ª–∏—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä - –ø–æ–ª–Ω—ã–π –º–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–π –æ—Ç—á–µ—Ç!")
            else:
                print("‚úÖ –û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω")
        
        print()
        print("üî¢ –ù–£–ú–ï–†–ê–¶–ò–Ø –°–¢–†–ê–ù–ò–¶:")
        print("   ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –≤–µ—Ä—Ö–Ω–∏–π –ø—Ä–∞–≤—ã–π —É–≥–æ–ª")
        print("   ‚úÖ –§–æ—Ä–º–∞—Ç: '–°—Ç—Ä. X'")
        print("   ‚úÖ –®—Ä–∏—Ñ—Ç: Arial-Regular, 10pt")
        print("   ‚úÖ –ü–æ–∑–∏—Ü–∏—è: 20–º–º –æ—Ç –ø—Ä–∞–≤–æ–≥–æ –∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ –∫—Ä–∞—è")
        print()
        print("üìã –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω—É–º–µ—Ä–∞—Ü–∏–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ PDF —Ñ–∞–π–ª!")
        
        return pdf_path
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–∞: {e}")
        import traceback
        traceback.print_exc()
        return None

if __name__ == "__main__":
    test_page_numbering()