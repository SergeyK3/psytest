#!/usr/bin/env python3
"""
–¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è PDF —Ç–æ–ª—å–∫–æ –≤ Google Drive (–±–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∫–æ–ø–∏–π)
"""

from enhanced_pdf_report_v2 import EnhancedPDFReportV2
from datetime import datetime
from pathlib import Path
import os

def test_gdrive_only_save():
    """–¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –≤ Google Drive"""
    print("‚òÅÔ∏è –¢–ï–°–¢ –°–û–•–†–ê–ù–ï–ù–ò–Ø –¢–û–õ–¨–ö–û –í GOOGLE DRIVE")
    print("=" * 60)
    print("üìå –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –æ–±–ª–∞–∫–µ")
    print("üóëÔ∏è –õ–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏ –¥–æ–ª–∂–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—Ç—å—Å—è")
    print()
    
    # –°–æ–∑–¥–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤
    report_generator = EnhancedPDFReportV2()
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    participant_name = "–¢–û–õ–¨–ö–û GOOGLE DRIVE"
    test_date = datetime.now().strftime("%Y-%m-%d")
    
    paei_scores = {
        "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å (E)": 90,
        "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (A)": 80,
        "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å (P)": 85,
        "–ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä (I)": 75
    }
    
    disc_scores = {
        "–î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (D)": 85,
        "–í–ª–∏—è–Ω–∏–µ (I)": 80,
        "–ü–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ (S)": 70,
        "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ (C)": 75
    }
    
    hexaco_scores = {
        "–ß–µ—Å—Ç–Ω–æ—Å—Ç—å": 90,
        "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å": 65,
        "–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è": 80,
        "–î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 85,
        "–î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å": 95,
        "–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–ø—ã—Ç—É": 75
    }
    
    soft_skills_scores = {
        "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 90,
        "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ": 85,
        "–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞": 80,
        "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å": 75,
        "–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º": 95
    }
    
    ai_interpretations = {
        'paei': '–í—ã–¥–∞—é—â–∏–µ—Å—è –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å —Å–∏–ª—å–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏–º–∏ –Ω–∞–≤—ã–∫–∞–º–∏.',
        'disc': '–õ–∏–¥–µ—Ä—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å —Å –≤—ã—Å–æ–∫–∏–º –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –≤–ª–∏—è–Ω–∏–µ–º.',
        'hexaco': '–ò—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–∞—è —á–µ—Å—Ç–Ω–æ—Å—Ç—å –∏ –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å - –∏–¥–µ–∞–ª—å–Ω—ã–π –∫–∞–Ω–¥–∏–¥–∞—Ç –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—è—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π.',
        'soft_skills': '–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏.'
    }
    
    # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
    out_path = Path(f"gdrive_only_test_{datetime.now().strftime('%Y%m%d_%H%M%S')}.pdf")
    
    print(f"üë§ –£—á–∞—Å—Ç–Ω–∏–∫: {participant_name}")
    print(f"üìÑ –í—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª: {out_path}")
    print("üì§ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –≤ Google Drive...")
    print()
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
    result = report_generator.generate_enhanced_report(
        participant_name=participant_name,
        test_date=test_date,
        paei_scores=paei_scores,
        disc_scores=disc_scores,
        hexaco_scores=hexaco_scores,
        soft_skills_scores=soft_skills_scores,
        ai_interpretations=ai_interpretations,
        out_path=out_path
    )
    
    print()
    print("üîç –ü–†–û–í–ï–†–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í:")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –æ—Å—Ç–∞–ª—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
    if os.path.exists(out_path):
        print(f"‚ùå –û–®–ò–ë–ö–ê: –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª {out_path} –≤—Å–µ –µ—â–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!")
    else:
        print(f"‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª {out_path} —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    if isinstance(result, str) and result.startswith("https://"):
        print(f"‚úÖ –í–æ–∑–≤—Ä–∞—â–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ Google Drive: {result}")
        print("‚úÖ –£–°–ü–ï–•: –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω —Ç–æ–ª—å–∫–æ –≤ Google Drive!")
    elif isinstance(result, Path):
        print(f"‚ö†Ô∏è –í–æ–∑–≤—Ä–∞—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å: {result}")
        print("‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω–∞ –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Google Drive")
    else:
        print(f"‚ùì –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {result}")
    
    print()
    print("‚úÖ –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù!")
    print("üìã –ò—Ç–æ–≥: PDF —Ñ–∞–π–ª—ã —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Google Drive")

if __name__ == "__main__":
    test_gdrive_only_save()