#!/usr/bin/env python3
"""
–°—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ—Ç—Å—Ç—É–ø–∞–º–∏
–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Google Drive –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞
"""

from enhanced_pdf_report import EnhancedPDFReportV2
from pathlib import Path
import datetime


def create_test_pdf_with_google_drive():
    """–°–æ–∑–¥–∞—ë—Ç —Ç–µ—Å—Ç–æ–≤—ã–π PDF —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤ Google Drive"""
    
    print("üéØ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ PDF —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –æ—Ç—Å—Ç—É–ø–∞–º–∏")
    print("=" * 60)
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –æ—Ç—Å—Ç—É–ø–æ–≤
    test_data = {
        'paei_scores': {
            'P': 4.5,  # –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å - –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∞—è —Ä–æ–ª—å
            'A': 3.2,  # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
            'E': 3.8,  # –ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å  
            'I': 3.1   # –ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä
        },
        'disc_scores': {
            'D': 7,    # –î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ - –≤—ã—Å–æ–∫–∏–π
            'I': 5,    # –í–ª–∏—è–Ω–∏–µ
            'S': 3,    # –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
            'C': 6     # –ü–æ–¥—á–∏–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º
        },
        'hexaco_scores': {
            'H': 3.9,  # –ß–µ—Å—Ç–Ω–æ—Å—Ç—å-–°–∫—Ä–æ–º–Ω–æ—Å—Ç—å
            'E': 4.1,  # –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
            'X': 4.3,  # –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è - –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∞—è
            'A': 3.7,  # –î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
            'C': 4.0,  # –î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å
            'O': 3.8   # –û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å
        },
        'soft_skills_scores': {
            '–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è': 8.5,            # –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å
            '–õ–∏–¥–µ—Ä—Å—Ç–≤–æ': 9.0,               # –î–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π –Ω–∞–≤—ã–∫
            '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ': 7.8,    
            '–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å': 7.2,
            '–†–∞–±–æ—Ç–∞ –≤ –∫–æ–º–∞–Ω–¥–µ': 8.1,
            '–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å': 7.5,
            '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç': 8.3,
            '–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º': 8.7,
            '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º': 7.9,
            '–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –Ω–∞–≤—ã–∫–∏': 8.0
        },
        'ai_interpretations': {
            'paei': """
            –Ø—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π —Ç–∏–ø –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å (P=4.5) —Å —Å–∏–ª—å–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–µ–π –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. 
            –•–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –≤—ã—Å–æ–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞—á, —Å—Ç—Ä–µ–º–ª–µ–Ω–∏–µ–º –∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—é 
            –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ü–µ–ª–µ–π –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —É—Å–ª–æ–≤–∏—è—Ö –¥–µ–¥–ª–∞–π–Ω–æ–≤. –•–æ—Ä–æ—à–æ —Ä–∞–∑–≤–∏—Ç—ã 
            –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ (E=3.8), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—á–µ—Ç–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö 
            –∑–∞–¥–∞—á —Å –ø–æ–∏—Å–∫–æ–º –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.
            """,
            'disc': """
            –î–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å (D=7) —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å 
            –∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –í—ã—Å–æ–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ –ü–æ–¥—á–∏–Ω–µ–Ω–∏—é –ø—Ä–∞–≤–∏–ª–∞–º (C=6) —Å–æ–∑–¥–∞—é—Ç 
            —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –ª–∏–¥–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—á–µ—Ç–∞–µ—Ç –Ω–∞–ø–æ—Ä–∏—Å—Ç–æ—Å—Ç—å —Å –≤–Ω–∏–º–∞–Ω–∏–µ–º –∫ –¥–µ—Ç–∞–ª—è–º 
            –∏ –∫–∞—á–µ—Å—Ç–≤—É. –¢–∞–∫–æ–π —Ç–∏–ø —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –≤ —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏—Ö –ø–æ–∑–∏—Ü–∏—è—Ö, —Ç—Ä–µ–±—É—é—â–∏—Ö –±—ã—Å—Ç—Ä—ã—Ö —Ä–µ—à–µ–Ω–∏–π.
            """,
            'hexaco': """
            –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å (X=4.3) —Å –≤—ã—Å–æ–∫–æ–π —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏ —ç–Ω–µ—Ä–≥–∏—á–Ω–æ—Å—Ç—å—é. 
            –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ –¥—Ä—É–≥–∏–º —Ñ–∞–∫—Ç–æ—Ä–∞–º —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å 
            —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö. –£–º–µ—Ä–µ–Ω–Ω–∞—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (E=4.1) 
            —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –≤ —Ä—É–∫–æ–≤–æ–¥—è—â–∏—Ö –ø–æ–∑–∏—Ü–∏—è—Ö.
            """,
            'soft_skills': """
            –í—ã–¥–∞—é—â–∏–µ—Å—è –ª–∏–¥–µ—Ä—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ (9.0 –±–∞–ª–ª–æ–≤) –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω—ã —Å–∏–ª—å–Ω—ã–º–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–º–∏ 
            –Ω–∞–≤—ã–∫–∞–º–∏ (8.5) –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é —Ä–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã (8.7). –í—ã—Å–æ–∫–∏–π —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç 
            (8.3) –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥–æ–π –∏ –º–æ—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. –ü—Ä–æ—Ñ–∏–ª—å 
            —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä—É–∫–æ–≤–æ–¥—è—â–∏–º –ø–æ–∑–∏—Ü–∏—è–º –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è.
            """
        }
    }
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
    timestamp = datetime.datetime.now().strftime("%Y%m%d_%H%M%S")
    filename = f"test_indents_report_{timestamp}.pdf"
    output_path = Path(filename)
    
    print(f"üìÑ –°–æ–∑–¥–∞–Ω–∏–µ PDF: {filename}")
    print(f"üìä –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:")
    print(f"   ‚Ä¢ PAEI: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å (P={test_data['paei_scores']['P']})")
    print(f"   ‚Ä¢ DISC: –î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (D={test_data['disc_scores']['D']})")
    print(f"   ‚Ä¢ HEXACO: –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è (X={test_data['hexaco_scores']['X']})")
    print(f"   ‚Ä¢ Soft Skills: –õ–∏–¥–µ—Ä—Å—Ç–≤–æ ({test_data['soft_skills_scores']['–õ–∏–¥–µ—Ä—Å—Ç–≤–æ']} –±–∞–ª–ª–æ–≤)")
    print()
    
    try:
        # –°–æ–∑–¥–∞—ë–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤
        generator = EnhancedPDFReportV2()
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º PDF —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏
        print("üîÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –æ—Ç—Å—Ç—É–ø–∞–º–∏...")
        result_path = generator.generate_enhanced_report(
            participant_name='–¢–µ—Å—Ç –û—Ç—Å—Ç—É–ø–æ–≤',
            test_date='2025-10-04',
            paei_scores=test_data['paei_scores'],
            disc_scores=test_data['disc_scores'],
            hexaco_scores=test_data['hexaco_scores'],
            soft_skills_scores=test_data['soft_skills_scores'],
            ai_interpretations=test_data['ai_interpretations'],
            out_path=output_path
        )
        
        print(f"‚úÖ PDF —Å–æ–∑–¥–∞–Ω: {result_path}")
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –≤ Google Drive
        print("üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Google Drive...")
        drive_url = generator.generate_enhanced_report_with_gdrive(
            participant_name='–¢–µ—Å—Ç –û—Ç—Å—Ç—É–ø–æ–≤',
            test_date='2025-10-04',
            paei_scores=test_data['paei_scores'],
            disc_scores=test_data['disc_scores'],
            hexaco_scores=test_data['hexaco_scores'],
            soft_skills_scores=test_data['soft_skills_scores'],
            ai_interpretations=test_data['ai_interpretations'],
            out_path=output_path
        )
        
        print("üéâ –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–û!")
        print("=" * 60)
        print(f"üìÅ –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª: {result_path.absolute()}")
        print(f"‚òÅÔ∏è  Google Drive: {drive_url}")
        print()
        print("üîç –ß–¢–û –ü–†–û–í–ï–†–ò–¢–¨ –í PDF:")
        print("   1. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º—É —Ä–∞–∑–≤–∏—Ç–∏—é:")
        print("      ‚Ä¢ –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏... (—Å –æ—Ç—Å—Ç—É–ø–æ–º)")
        print("      ‚Ä¢ –†–∞–∑–≤–∏–≤–∞—Ç—å –ª–∏–¥–µ—Ä—Å—Ç–≤–æ... (—Å –æ—Ç—Å—Ç—É–ø–æ–º)")
        print("      ‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ... (—Å –æ—Ç—Å—Ç—É–ø–æ–º)")
        print()
        print("   2. –ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è:")
        print("      ‚Ä¢ –£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å... (—Å –æ—Ç—Å—Ç—É–ø–æ–º)")
        print("      ‚Ä¢ –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π —Ç–∏–ø DISC... (—Å –æ—Ç—Å—Ç—É–ø–æ–º)")
        print()
        print("   3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥–∏–∫–∏:")
        print("      ‚Ä¢ –¢–µ—Å—Ç –ê–¥–∏–∑–µ—Å–∞ (PAEI)... (—Å –æ—Ç—Å—Ç—É–ø–æ–º)")
        print("      ‚Ä¢ –û—Ü–µ–Ω–∫–∞ Soft Skills... (—Å –æ—Ç—Å—Ç—É–ø–æ–º)")
        print()
        print("   4. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ PAEI, HEXACO, DISC:")
        print("      ‚Ä¢ –í—Å–µ –ø—É–Ω–∫—Ç—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –æ—Ç—Å—Ç—É–ø—ã")
        
        return result_path, drive_url
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        return None, None


if __name__ == "__main__":
    create_test_pdf_with_google_drive()