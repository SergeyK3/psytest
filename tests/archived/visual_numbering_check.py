#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ВИЗУАЛЬНЫЙ КОНТРОЛЬ НУМЕРАЦИИ СТРАНИЦ
Создание отчета для проверки нумерации в Google Drive
"""

from pathlib import Path
from datetime import datetime
from enhanced_pdf_report_v2 import EnhancedPDFReportV2

def visual_page_numbering_test():
    """
    Создание отчета для визуального контроля нумерации страниц
    """
    print("👁️ ВИЗУАЛЬНЫЙ КОНТРОЛЬ НУМЕРАЦИИ СТРАНИЦ")
    print("=" * 60)
    print("🔢 Создаем отчет с четкой нумерацией для проверки")
    print("📤 Загружаем в Google Drive для визуального контроля")
    print()
    
    # Создание генератора
    generator = EnhancedPDFReportV2()
    
    # Данные для отчета с визуальным контролем
    participant_name = "ВИЗУАЛЬНЫЙ КОНТРОЛЬ НУМЕРАЦИИ"
    test_date = datetime.now().strftime("%Y-%m-%d")
    
    paei_scores = {"P": 9, "A": 7, "E": 8, "I": 6}
    disc_scores = {"D": 8, "I": 9, "S": 4, "C": 5}
    hexaco_scores = {"H": 4, "E": 5, "X": 4, "A": 3, "C": 4, "O": 5}
    
    soft_skills_scores = {
        "Лидерство": 9, "Коммуникация": 10, "Креативность": 8, "Аналитика": 7,
        "Адаптивность": 9, "Командная работа": 8, "Эмпатия": 9, 
        "Критическое мышление": 8, "Управление временем": 7, "Решение проблем": 9
    }
    
    # Развернутые интерпретации для создания многостраничного документа
    ai_interpretations = {
        "paei": """
        ДЕТАЛЬНЫЙ АНАЛИЗ РЕЗУЛЬТАТОВ PAEI (СТРАНИЦА 2-3):
        
        Результаты тестирования по методике Адизеса демонстрируют ярко выраженные 
        управленческие способности с преобладанием роли Производителя (P=9). Это 
        указывает на исключительную ориентацию на результат, высокую эффективность 
        в достижении поставленных целей и способность мотивировать себя и других 
        на выполнение конкретных задач.
        
        Сильные позиции по роли Предпринимателя (E=8) дополняют профиль способностью 
        к стратегическому мышлению, инновационному подходу и видению перспектив 
        развития бизнеса. Такое сочетание P и E ролей характерно для успешных 
        руководителей среднего и высшего звена.
        
        Умеренно высокие показатели Администратора (A=7) свидетельствуют о хороших 
        организационных навыках и способности к систематизации рабочих процессов. 
        Это важное дополнение к предпринимательскому и производственному стилям.
        
        Показатели Интегратора (I=6) находятся на приемлемом уровне, что указывает 
        на базовые навыки работы с людьми и способность к командному взаимодействию, 
        хотя эта область может потребовать дополнительного развития.
        """,
        "disc": """
        ПОДРОБНЫЙ АНАЛИЗ ПРОФИЛЯ DISC (СТРАНИЦА 3-4):
        
        Анализ поведенческого профиля DISC выявляет доминирование стиля Влияния (I=9), 
        что является показателем выдающихся коммуникативных способностей, природной 
        харизмы и умения вдохновлять окружающих. Люди с высоким показателем I 
        естественным образом становятся центром внимания, легко устанавливают 
        контакты и эффективно презентуют свои идеи.
        
        Высокое Доминирование (D=8) прекрасно дополняет профиль Влияния, добавляя 
        решительность, инициативность и способность принимать быстрые решения в 
        условиях неопределенности. Такая комбинация D и I характерна для прирожденных 
        лидеров, способных как вдохновлять команду, так и принимать tough decisions.
        
        Относительно низкие показатели Соответствия (C=5) и Постоянства (S=4) указывают 
        на предпочтение динамичной рабочей среды, готовность к изменениям и склонность 
        к инновационным подходам в работе. Это профиль человека, который процветает 
        в условиях вызовов и изменений.
        """,
        "hexaco": """
        КОМПЛЕКСНЫЙ АНАЛИЗ ЛИЧНОСТИ HEXACO (СТРАНИЦА 4-5):
        
        Личностный профиль по модели HEXACO демонстрирует интересные особенности 
        характера с акцентом на Открытость опыту (O=5) и Экстраверсию (X=4). 
        Высокая открытость новому опыту свидетельствует о любознательности, 
        креативности и готовности к интеллектуальным вызовам.
        
        Умеренная Эмоциональность (E=5) указывает на эмоциональную стабильность и 
        способность сохранять спокойствие в стрессовых ситуациях. Это важное качество 
        для руководящих позиций, требующих принятия решений под давлением.
        
        Показатели Честности-Скромности (H=4), Добросовестности (C=4) и 
        Доброжелательности (A=3) находятся в пределах нормы, что говорит о 
        сбалансированном подходе к межличностным отношениям и рабочим обязанностям.
        
        ПРОВЕРЬТЕ НУМЕРАЦИЮ НА КАЖДОЙ СТРАНИЦЕ В ВЕРХНЕМ ПРАВОМ УГЛУ!
        """
    }
    
    # Создание файла с названием для визуального контроля
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    filename = f"VISUAL_CHECK_NUMBERING_{timestamp}.pdf"
    out_path = Path(filename)
    
    print(f"📄 Создание отчета: {filename}")
    print(f"👤 Участник: {participant_name}")
    print(f"🔢 Ожидается: 4-5 страниц с нумерацией в верхнем правом углу")
    print()
    
    try:
        # Генерация с Google Drive для визуального контроля
        pdf_path, gdrive_link = generator.generate_enhanced_report_with_gdrive(
            participant_name=participant_name,
            test_date=test_date,
            paei_scores=paei_scores,
            disc_scores=disc_scores,
            hexaco_scores=hexaco_scores,
            soft_skills_scores=soft_skills_scores,
            ai_interpretations=ai_interpretations,
            out_path=out_path,
            upload_to_gdrive=True
        )
        
        print("✅ ОТЧЕТ ДЛЯ ВИЗУАЛЬНОГО КОНТРОЛЯ СОЗДАН!")
        print(f"📄 Локальный файл: {pdf_path}")
        
        if gdrive_link:
            print()
            print("📱 ССЫЛКА ДЛЯ ВИЗУАЛЬНОГО КОНТРОЛЯ:")
            print(f"🔗 {gdrive_link}")
            print()
            print("👁️ ИНСТРУКЦИЯ ПО ПРОВЕРКЕ:")
            print("   1. Откройте ссылку в браузере")
            print("   2. Проверьте КАЖДУЮ страницу")
            print("   3. Убедитесь, что в ВЕРХНЕМ ПРАВОМ углу есть 'Стр. X'")
            print("   4. Проверьте последовательность: Стр. 1, Стр. 2, Стр. 3, и т.д.")
            print("   5. Нумерация должна быть четкой и читаемой")
        else:
            print("❌ Google Drive: загрузка не выполнена")
        
        # Информация о размере
        if pdf_path.exists():
            size = pdf_path.stat().st_size
            size_kb = size / 1024
            print(f"📊 Размер файла: {size} байт ({size_kb:.1f} KB)")
            
            if size > 500000:
                print("✅ Размер соответствует многостраничному отчету")
            
        print()
        print("🎯 ГОТОВО ДЛЯ ВИЗУАЛЬНОГО КОНТРОЛЯ!")
        print("📋 Проверьте нумерацию страниц по ссылке выше")
        
        return pdf_path, gdrive_link
        
    except Exception as e:
        print(f"❌ Ошибка создания отчета: {e}")
        import traceback
        traceback.print_exc()
        return None, None

if __name__ == "__main__":
    visual_page_numbering_test()