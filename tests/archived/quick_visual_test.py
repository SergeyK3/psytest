#!/usr/bin/env python3
"""
–ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
"""

from enhanced_pdf_report_v2 import EnhancedPDFReportV2
from datetime import datetime
from pathlib import Path

def visual_control_unified():
    """–°–æ–∑–¥–∞–Ω–∏–µ PDF –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞"""
    print("üëÅÔ∏è –í–ò–ó–£–ê–õ–¨–ù–´–ô –ö–û–ù–¢–†–û–õ–¨ –û–ë–™–ï–î–ò–ù–ï–ù–ù–û–ì–û –†–ê–ó–î–ï–õ–ê")
    print("=" * 60)
    print("üîó –û–±—ä–µ–¥–∏–Ω–µ–Ω—ã: '–ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏' + '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥–∏–∫–∏'")
    print("üì§ –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Google Drive –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏...")
    print()
    
    report_generator = EnhancedPDFReportV2()
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    participant_name = "–í–ò–ó–£–ê–õ–¨–ù–´–ô –ö–û–ù–¢–†–û–õ–¨ –û–ë–™–ï–î–ò–ù–ï–ù–ò–Ø"
    test_date = datetime.now().strftime("%Y-%m-%d")
    
    paei_scores = {
        "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å (E)": 85,
        "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (A)": 70,
        "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å (P)": 92,
        "–ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä (I)": 68
    }
    
    disc_scores = {
        "–î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (D)": 78,
        "–í–ª–∏—è–Ω–∏–µ (I)": 82,
        "–ü–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ (S)": 65,
        "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ (C)": 90
    }
    
    hexaco_scores = {
        "–ß–µ—Å—Ç–Ω–æ—Å—Ç—å": 88,
        "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å": 62,
        "–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è": 75,
        "–î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 80,
        "–î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å": 93,
        "–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–ø—ã—Ç—É": 72
    }
    
    soft_skills_scores = {
        "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 86,
        "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ": 81,
        "–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞": 78,
        "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å": 74,
        "–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º": 91
    }
    
    ai_interpretations = {
        'paei': '–°–∏–ª—å–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞–º–∏.',
        'disc': '–í—ã—Å–æ–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –≤–ª–∏—è–Ω–∏—è, —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å.',
        'hexaco': '–û—Ç–ª–∏—á–Ω–∞—è –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å –∏ —á–µ—Å—Ç–Ω–æ—Å—Ç—å.',
        'soft_skills': '–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏.'
    }
    
    out_path = Path(f"visual_unified_control_{datetime.now().strftime('%Y%m%d_%H%M%S')}.pdf")
    
    print(f"üë§ –£—á–∞—Å—Ç–Ω–∏–∫: {participant_name}")
    print("üìÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–º —Ä–∞–∑–¥–µ–ª–æ–º...")
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
    result = report_generator.generate_enhanced_report(
        participant_name=participant_name,
        test_date=test_date,
        paei_scores=paei_scores,
        disc_scores=disc_scores,
        hexaco_scores=hexaco_scores,
        soft_skills_scores=soft_skills_scores,
        ai_interpretations=ai_interpretations,
        out_path=out_path
    )
    
    print()
    if isinstance(result, str) and result.startswith("https://"):
        print("‚úÖ PDF —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ Google Drive!")
        print(f"üîó –°–°–´–õ–ö–ê –î–õ–Ø –í–ò–ó–£–ê–õ–¨–ù–û–ì–û –ö–û–ù–¢–†–û–õ–Ø:")
        print(f"üîó {result}")
        print()
        print("üëÅÔ∏è –ß–¢–û –ü–†–û–í–ï–†–ò–¢–¨:")
        print("   1. –†–∞–∑–¥–µ–ª '–ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥–∏–∫–∏'")
        print("   2. –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ –æ–¥–Ω–æ–º –±–ª–æ–∫–µ")
        print("   3. –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –≤–µ—Ä—Å—Ç–∫–∞ –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è")
        print("   4. –ò–º—è —É—á–∞—Å—Ç–Ω–∏–∫–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É –±–µ–∑ '–ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:'")
    else:
        print(f"‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞: {result}")
    
    print()
    print("‚úÖ –ì–û–¢–û–í–û –î–õ–Ø –í–ò–ó–£–ê–õ–¨–ù–û–ì–û –ö–û–ù–¢–†–û–õ–Ø!")

if __name__ == "__main__":
    visual_control_unified()