#!/usr/bin/env python3
"""
–¢–µ—Å—Ç –Ω–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏–π —Ç–µ—Å—Ç–æ–≤ –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ —Ä–∞–∑–¥–µ–ª–æ–≤
"""

import sys
from pathlib import Path
sys.path.append(str(Path(__file__).parent.parent))

from enhanced_pdf_report_v2 import EnhancedPDFReportV2
from datetime import datetime

def test_test_descriptions_placement():
    """–¢–µ—Å—Ç —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏–π —Ç–µ—Å—Ç–æ–≤ –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∫–∞–∫ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ"""
    print("üìã –¢–ï–°–¢ –†–ê–ó–ú–ï–©–ï–ù–ò–Ø –û–ü–ò–°–ê–ù–ò–ô –¢–ï–°–¢–û–í")
    print("=" * 60)
    print("‚úÖ –û–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ —Ä–∞–∑–º–µ—â–µ–Ω—ã –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ —Ä–∞–∑–¥–µ–ª–æ–≤")
    print("‚úÖ –§–æ—Ä–º–∞—Ç –∫–∞–∫ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ —Å –∫—Ä–∞—Å–Ω–æ–π —Ä–∞–º–∫–æ–π")
    print("‚úÖ –ö—Ä–∞—Ç–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ")
    print()
    
    # –°–æ–∑–¥–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤
    report_generator = EnhancedPDFReportV2()
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    participant_name = "–¢–ï–°–¢ –†–ê–ó–ú–ï–©–ï–ù–ò–Ø –û–ü–ò–°–ê–ù–ò–ô"
    test_date = datetime.now().strftime("%Y-%m-%d")
    
    paei_scores = {
        "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å (E)": 89,
        "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (A)": 84,
        "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å (P)": 92,
        "–ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä (I)": 79
    }
    
    disc_scores = {
        "–î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (D)": 87,
        "–í–ª–∏—è–Ω–∏–µ (I)": 83,
        "–ü–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ (S)": 74,
        "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ (C)": 91
    }
    
    hexaco_scores = {
        "–ß–µ—Å—Ç–Ω–æ—Å—Ç—å": 94,
        "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å": 67,
        "–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è": 82,
        "–î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 88,
        "–î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å": 97,
        "–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–ø—ã—Ç—É": 81
    }
    
    soft_skills_scores = {
        "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 90,
        "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ": 87,
        "–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞": 84,
        "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å": 78,
        "–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º": 95
    }
    
    ai_interpretations = {
        'paei': '–í—ã–¥–∞—é—â–∏–µ—Å—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å —Å–∏–ª—å–Ω—ã–º–∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞–º–∏.',
        'disc': '–ü—Ä–æ—Ñ–∏–ª—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º —Å –≤—ã—Å–æ–∫–∏–º –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º - –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á.',
        'hexaco': '–ò—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å –∏ —á–µ—Å—Ç–Ω–æ—Å—Ç—å, –≤—ã—Å–æ–∫–∏–µ –º–æ—Ä–∞–ª—å–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã.',
        'soft_skills': '–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —Å —Å–∏–ª—å–Ω—ã–º–∏ –ª–∏–¥–µ—Ä—Å–∫–∏–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞–º–∏.'
    }
    
    # –°–æ–∑–¥–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞
    out_path = Path(f"test_descriptions_placement_{datetime.now().strftime('%Y%m%d_%H%M%S')}.pdf")
    
    print(f"üë§ –£—á–∞—Å—Ç–Ω–∏–∫: {participant_name}")
    print("üìÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF —Å –Ω–æ–≤—ã–º —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º –æ–ø–∏—Å–∞–Ω–∏–π...")
    print()
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
    result = report_generator.generate_enhanced_report(
        participant_name=participant_name,
        test_date=test_date,
        paei_scores=paei_scores,
        disc_scores=disc_scores,
        hexaco_scores=hexaco_scores,
        soft_skills_scores=soft_skills_scores,
        ai_interpretations=ai_interpretations,
        out_path=out_path
    )
    
    print()
    print("üîç –†–ï–ó–£–õ–¨–¢–ê–¢:")
    if isinstance(result, str) and result.startswith("https://"):
        print(f"‚úÖ PDF —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ Google Drive!")
        print(f"üîó –°–°–´–õ–ö–ê –î–õ–Ø –ü–†–û–í–ï–†–ö–ò:")
        print(f"üîó {result}")
        print()
        print("üëÅÔ∏è –ß–¢–û –ü–†–û–í–ï–†–ò–¢–¨ –í PDF:")
        print("   1. –†–∞–∑–¥–µ–ª '1. –¢–ï–°–¢ –ê–î–ò–ó–ï–°–ê (PAEI)' - –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ —Å—Ä–∞–∑—É –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º")
        print("   2. –†–∞–∑–¥–µ–ª '2. SOFT SKILLS' - –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º")
        print("   3. –†–∞–∑–¥–µ–ª '3. –¢–ï–°–¢ HEXACO' - –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º")
        print("   4. –†–∞–∑–¥–µ–ª '4. –¢–ï–°–¢ DISC' - –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º")
        print("   5. –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∫—Ä–∞—Ç–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã")
        print("   6. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç—É")
        
        return result
    else:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–∞: {result}")
        return None

if __name__ == "__main__":
    test_test_descriptions_placement()