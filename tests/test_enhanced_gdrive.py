#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–¢–ï–°–¢ ENHANCED PDF V4.0 + GOOGLE DRIVE –ó–ê–ì–†–£–ó–ö–ê
–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ —Å —Ä–∏—Å—É–Ω–∫–∞–º–∏ –∏ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ Google –ø–∞–ø–∫—É
"""

from pathlib import Path
from datetime import datetime
from enhanced_pdf_report_v2 import EnhancedPDFReportV2

def test_enhanced_with_google_drive():
    """
    –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è enhanced –æ—Ç—á–µ—Ç–∞ —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ Google Drive
    """
    print("üöÄ –¢–ï–°–¢ ENHANCED PDF V4.0 + GOOGLE DRIVE")
    print("=" * 60)
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
    generator = EnhancedPDFReportV2()
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    participant_name = "Enhanced Google Drive Test"
    test_date = datetime.now().strftime("%Y-%m-%d")
    
    paei_scores = {"P": 8, "A": 6, "E": 9, "I": 7}
    disc_scores = {"D": 7, "I": 8, "S": 5, "C": 6}
    hexaco_scores = {"H": 4, "E": 3, "X": 5, "A": 4, "C": 5, "O": 4}
    
    soft_skills_scores = {
        "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ": 8, "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 9, "–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 7, "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞": 6,
        "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å": 8, "–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞": 9, "–≠–º–ø–∞—Ç–∏—è": 8, 
        "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ": 7, "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º": 6, "–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º": 8
    }
    
    # –î–µ—Ç–∞–ª—å–Ω—ã–µ AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏
    ai_interpretations = {
        "paei": """
        –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ PAEI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ —Ä–æ–ª–∏ –ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—è (E=9), 
        —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã—Å–æ–∫—É—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å 
        –∫ –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º. –°–∏–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è (P=8) –¥–æ–ø–æ–ª–Ω—è—é—Ç –ø—Ä–æ—Ñ–∏–ª—å 
        –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–µ–π –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á. –£–º–µ—Ä–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ 
        –ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä–∞ (I=7) —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É—é—Ç –æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∫ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç–µ, 
        –∞ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (A=6) - –æ –±–∞–∑–æ–≤—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö –Ω–∞–≤—ã–∫–∞—Ö.
        """,
        "disc": """
        –ü—Ä–æ—Ñ–∏–ª—å DISC –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –í–ª–∏—è–Ω–∏—è (I=8) –∏ –î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (D=7).
        –≠—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –¥–ª—è —Ö–∞—Ä–∏–∑–º–∞—Ç–∏—á–Ω—ã—Ö –ª–∏–¥–µ—Ä–æ–≤, —Å–ø–æ—Å–æ–±–Ω—ã—Ö –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥—É
        –∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –±—ã—Å—Ç—Ä—ã–µ —Ä–µ—à–µ–Ω–∏—è. –í—ã—Å–æ–∫–æ–µ –í–ª–∏—è–Ω–∏–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–µ
        —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏ —É–º–µ–Ω–∏–µ —É–±–µ–∂–¥–∞—Ç—å. –ù–∏–∑–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ü–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–∞ (S=5) –∏ 
        –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è (C=6) –≥–æ–≤–æ—Ä—è—Ç –æ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–∏ –¥–∏–Ω–∞–º–∏—á–Ω–æ–π —Ä–∞–±–æ—á–µ–π —Å—Ä–µ–¥—ã.
        """,
        "hexaco": """
        –õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å HEXACO –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        —Å —É–º–µ—Ä–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤—É —Ñ–∞–∫—Ç–æ—Ä–æ–≤. –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è (X=5) –∏ 
        –î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å (C=5) –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ —Å—Ä–µ–¥–Ω–µ–º —É—Ä–æ–≤–Ω–µ, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞
        –≥–∏–±–∫–æ—Å—Ç—å –≤ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Å–∏—Ç—É–∞—Ü–∏—è–º.
        –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã —Ç–∞–∫–∂–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏.
        """
    }
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    safe_name = "".join(c for c in participant_name if c.isalnum() or c in (' ', '-', '_')).rstrip()
    safe_name = safe_name.replace(' ', '_')
    filename = f"enhanced_gdrive_{safe_name}_{timestamp}.pdf"
    out_path = Path(filename)
    
    print(f"üìÑ –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞: {filename}")
    print(f"üë§ –£—á–∞—Å—Ç–Ω–∏–∫: {participant_name}")
    print(f"üìÖ –î–∞—Ç–∞: {test_date}")
    print()
    
    try:
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å Google Drive
        pdf_path, gdrive_link = generator.generate_enhanced_report_with_gdrive(
            participant_name=participant_name,
            test_date=test_date,
            paei_scores=paei_scores,
            disc_scores=disc_scores,
            hexaco_scores=hexaco_scores,
            soft_skills_scores=soft_skills_scores,
            ai_interpretations=ai_interpretations,
            out_path=out_path,
            upload_to_gdrive=True
        )
        
        print("‚úÖ ENHANCED –û–¢–ß–ï–¢ –° GOOGLE DRIVE –°–û–ó–î–ê–ù!")
        print(f"üìÑ –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª: {pdf_path}")
        
        if gdrive_link:
            print(f"‚òÅÔ∏è Google Drive: {gdrive_link}")
            print("üéØ –û—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –º–µ—Å—è—á–Ω—É—é –ø–∞–ø–∫—É Google Drive!")
        else:
            print("‚ö†Ô∏è Google Drive: –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞
        if pdf_path.exists():
            size = pdf_path.stat().st_size
            size_kb = size / 1024
            print(f"üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {size} –±–∞–π—Ç ({size_kb:.1f} KB)")
            
            if size > 500000:  # –ë–æ–ª—å—à–µ 500KB
                print("‚úÖ –û—Ç–ª–∏—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä - –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏!")
                print("üìà –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ 4 —Ç–µ—Å—Ç–∞ —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏")
            elif size > 100000:  # –ë–æ–ª—å—à–µ 100KB
                print("‚úÖ –•–æ—Ä–æ—à–∏–π —Ä–∞–∑–º–µ—Ä - –æ—Ç—á–µ—Ç —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ —Å–æ–∑–¥–∞–Ω")
            else:
                print("‚ö†Ô∏è –ú–∞–ª–µ–Ω—å–∫–∏–π —Ä–∞–∑–º–µ—Ä - –≤–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã")
        
        print()
        print("üéâ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û –£–°–ü–ï–®–ù–û!")
        print("üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:")
        print(f"   ‚Ä¢ PDF —Å–æ–∑–¥–∞–Ω: ‚úÖ")
        print(f"   ‚Ä¢ –†–∞–∑–º–µ—Ä: {size_kb:.1f} KB")
        print(f"   ‚Ä¢ Google Drive: {'‚úÖ' if gdrive_link else '‚ùå'}")
        print(f"   ‚Ä¢ –ì—Ä–∞—Ñ–∏–∫–∏: ‚úÖ (–≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ PDF)")
        
        return pdf_path, gdrive_link
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è enhanced –æ—Ç—á–µ—Ç–∞: {e}")
        import traceback
        traceback.print_exc()
        return None, None

if __name__ == "__main__":
    test_enhanced_with_google_drive()