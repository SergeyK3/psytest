#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–§–ò–ù–ê–õ–¨–ù–´–ô –ì–ï–ù–ï–†–ê–¢–û–† PDF –° –ü–û–õ–ù–´–ú –û–ë–™–ï–ú–û–ú –ò –ü–†–ê–í–ò–õ–¨–ù–û–ô –ù–£–ú–ï–†–ê–¶–ò–ï–ô

–û–±—ä–µ–¥–∏–Ω—è–µ—Ç:
1. –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ enhanced_pdf_report_v2.py (12-14 —Å—Ç—Ä–∞–Ω–∏—Ü, –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è)
2. –ü—Ä–∞–≤–∏–ª—å–Ω—É—é –Ω—É–º–µ—Ä–∞—Ü–∏—é –∏–∑ working_pdf_generator.py (WorkingNumberedCanvas)
3.                                    hexaco_scores: Dict[str, float] = None,
                                   soft_skills_scores: Dict[str, float] = None,
                                   ai_interpretations: Dict[str, str] = None,
                                   filename: str = "final_full_numbered_report.pdf",
                                   upload_to_gdrive: bool = True) -> Tuple[str, Optional[str]]:–∞–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Arial –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã)

–°–æ–∑–¥–∞–Ω: 05.10.2025
–°—Ç–∞—Ç—É—Å: ‚úÖ –û–ë–™–ï–î–ò–ù–Ø–ï–¢ –í–°–ï –†–ï–®–ï–ù–ò–Ø
"""

from pathlib import Path
import os
from typing import Dict, List, Tuple, Optional
from reportlab.lib.pagesizes import A4
from reportlab.lib.units import mm, cm
from reportlab.pdfgen import canvas
from reportlab.lib.colors import Color, black, white
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle
from reportlab.platypus import PageBreak, KeepTogether, Image
from reportlab.pdfbase import pdfmetrics
from reportlab.pdfbase.ttfonts import TTFont
from datetime import datetime
import tempfile
import shutil

# Google Drive –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
try:
    from oauth_google_drive import upload_to_google_drive_oauth
    GOOGLE_DRIVE_AVAILABLE = True
    print("‚úÖ Google Drive –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞")
except ImportError:
    GOOGLE_DRIVE_AVAILABLE = False
    print("‚ö†Ô∏è Google Drive –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞")

# –†–∞–±–æ—á–∏–π Canvas —Å –ø–æ–ª–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π –∏–∑ working_pdf_generator.py
class FinalNumberedCanvas(canvas.Canvas):
    """–§–ò–ù–ê–õ–¨–ù–´–ô Canvas —Å –ø–æ–ª–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π '–°—Ç—Ä. X –∏–∑ N'"""
    def __init__(self, *args, **kwargs):
        canvas.Canvas.__init__(self, *args, **kwargs)
        self._saved_page_states = []

    def showPage(self):
        self._saved_page_states.append(dict(self.__dict__))
        self._startPage()

    def save(self):
        """–î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –Ω–∞ –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"""
        num_pages = len(self._saved_page_states)
        for (page_num, page_state) in enumerate(self._saved_page_states):
            self.__dict__.update(page_state)
            self.draw_page_number(page_num + 1, num_pages)
            canvas.Canvas.showPage(self)
        canvas.Canvas.save(self)

    def draw_page_number(self, page_num, total_pages):
        """–ù–£–ú–ï–†–ê–¶–ò–Ø –í –ö–û–õ–û–ù–¢–ò–¢–£–õ–ï: –ø—Ä–∞–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ X –∏–∑ N"""
        # –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Arial –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
        try:
            arial_path = "C:/Windows/Fonts/arial.ttf"
            if os.path.exists(arial_path):
                # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º Arial –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
                pdfmetrics.registerFont(TTFont('Arial-Final', arial_path))
                self.setFont("Arial-Final", 10)
                text = f"{page_num} –∏–∑ {total_pages}"  # –£–±–∏—Ä–∞–µ–º "–°—Ç—Ä." –¥–ª—è –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª–∞
            else:
                raise Exception("Arial not found")
        except:
            # Fallback –Ω–∞ Times-Roman
            self.setFont("Times-Roman", 10)
            text = f"{page_num} –∏–∑ {total_pages}"  # –£–±–∏—Ä–∞–µ–º "–°—Ç—Ä." –¥–ª—è –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª–∞
        
        # –ü–æ–∑–∏—Ü–∏—è –≤ –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª–µ - –ø—Ä–∞–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª
        # A4[1] - 10*mm = –ø–æ–∑–∏—Ü–∏—è –≤ —Å–∞–º–æ–º –≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª)
        self.drawRightString(A4[0] - 20*mm, A4[1] - 10*mm, text)

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–∏–∑–∞–π–Ω–∞
class DesignConfig:
    """–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–∏–∑–∞–π–Ω–∞ –¥–ª—è –ø–µ—á–∞—Ç–∏"""
    
    # –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —á/–± –ø–µ—á–∞—Ç–∏)
    PRIMARY_COLOR = Color(0.18, 0.25, 0.34)      # #2E4057 —Ç—ë–º–Ω–æ-—Å–∏–Ω–∏–π
    ACCENT_COLOR = Color(0.29, 0.56, 0.72)       # #4A90B8 —Å–≤–µ—Ç–ª–æ-—Å–∏–Ω–∏–π  
    TEXT_COLOR = Color(0.17, 0.17, 0.17)         # #2C2C2C —Ç—ë–º–Ω–æ-—Å–µ—Ä—ã–π
    LIGHT_GRAY = Color(0.9, 0.9, 0.9)            # #E6E6E6 —Å–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π
    WHITE = Color(1, 1, 1)                        # #FFFFFF –±–µ–ª—ã–π
    
    # –†–∞–∑–º–µ—Ä—ã (–≤ –º–º)
    PAGE_WIDTH = 210
    PAGE_HEIGHT = 297
    MARGIN = 20
    
    # –®—Ä–∏—Ñ—Ç—ã (–∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ Unicode —à—Ä–∏—Ñ—Ç—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã)
    TITLE_FONT = "Times-Bold"
    BODY_FONT = "Times-Roman"
    SMALL_FONT = "Times-Roman"
    
    TITLE_SIZE = 14
    BODY_SIZE = 11
    SMALL_SIZE = 9

class FinalFullVolumeGenerator:
    """–§–ò–ù–ê–õ–¨–ù–´–ô –ì–ï–ù–ï–†–ê–¢–û–† —Å –ø–æ–ª–Ω—ã–º –æ–±—ä–µ–º–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π"""
    
    def __init__(self):
        self._setup_fonts()
    
    def _setup_fonts(self):
        """–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —à—Ä–∏—Ñ—Ç—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã"""
        try:
            # –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã Windows —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π
            windows_fonts = "C:/Windows/Fonts/"
            
            # –°–ø–∏—Å–æ–∫ —à—Ä–∏—Ñ—Ç–æ–≤ –≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è
            font_candidates = [
                ("arial.ttf", "Arial-Regular"),
                ("arialbd.ttf", "Arial-Bold"), 
                ("times.ttf", "Times-Regular"),
                ("timesbd.ttf", "Times-Bold"),
            ]
            
            fonts_registered = {}
            
            for font_file, font_name in font_candidates:
                font_path = os.path.join(windows_fonts, font_file)
                if os.path.exists(font_path):
                    try:
                        pdfmetrics.registerFont(TTFont(font_name, font_path))
                        fonts_registered[font_name] = True
                        print(f"‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —à—Ä–∏—Ñ—Ç: {font_name}")
                    except Exception as e:
                        print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å {font_name}: {e}")
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —à—Ä–∏—Ñ—Ç–æ–≤
            if "Arial-Regular" in fonts_registered:
                DesignConfig.BODY_FONT = "Arial-Regular"
                print("[INFO] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Arial-Regular –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞")
            elif "Times-Regular" in fonts_registered:
                DesignConfig.BODY_FONT = "Times-Regular"
                print("[INFO] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Times-Regular –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞")
            else:
                DesignConfig.BODY_FONT = "Times-Roman"
                print("[INFO] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Times-Roman –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞")
            
            if "Arial-Bold" in fonts_registered:
                DesignConfig.TITLE_FONT = "Arial-Bold"
                print("[INFO] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Arial-Bold –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤")
            elif "Times-Bold" in fonts_registered:
                DesignConfig.TITLE_FONT = "Times-Bold"
                print("[INFO] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Times-Bold –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤")
            else:
                DesignConfig.TITLE_FONT = "Times-Bold"
                print("[INFO] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Times-Bold –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤")
                
        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —à—Ä–∏—Ñ—Ç–æ–≤: {e}")
            print("üìù –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã Times")

    def _get_custom_styles(self):
        """–°–æ–∑–¥–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–∏–ª–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã"""
        styles = getSampleStyleSheet()
        
        # –ì–ª–∞–≤–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
        styles.add(ParagraphStyle(
            name='MainTitle',
            parent=styles['Title'],
            fontSize=DesignConfig.TITLE_SIZE + 4,
            spaceAfter=15*mm,
            alignment=1,  # —Ü–µ–Ω—Ç—Ä
            fontName=DesignConfig.TITLE_FONT,
            textColor=DesignConfig.PRIMARY_COLOR
        ))
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏
        styles.add(ParagraphStyle(
            name='SectionTitle',
            parent=styles['Heading1'],
            fontSize=DesignConfig.TITLE_SIZE,
            spaceAfter=8*mm,
            spaceBefore=5*mm,
            fontName=DesignConfig.TITLE_FONT,
            textColor=DesignConfig.PRIMARY_COLOR
        ))
        
        # –ù–µ—Ä–∞–∑—Ä—ã–≤–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
        styles.add(ParagraphStyle(
            name='UnbreakableTitle',
            parent=styles['Heading1'],
            fontSize=DesignConfig.TITLE_SIZE,
            spaceAfter=8*mm,
            spaceBefore=5*mm,
            fontName=DesignConfig.TITLE_FONT,
            textColor=DesignConfig.PRIMARY_COLOR,
            keepWithNext=True  # –ù–µ —Ä–∞–∑—Ä—ã–≤–∞—Ç—å —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–º
        ))
        
        # –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫
        styles.add(ParagraphStyle(
            name='SubTitle',
            parent=styles['Heading2'],
            fontSize=DesignConfig.BODY_SIZE + 1,
            spaceAfter=4*mm,
            fontName=DesignConfig.TITLE_FONT,
            textColor=DesignConfig.PRIMARY_COLOR
        ))
        
        # –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç
        styles.add(ParagraphStyle(
            name='Body',
            parent=styles['Normal'],
            fontSize=DesignConfig.BODY_SIZE,
            spaceAfter=3*mm,
            fontName=DesignConfig.BODY_FONT,
            textColor=DesignConfig.TEXT_COLOR
        ))
        
        return styles

    def _format_scores(self, scores: Dict[str, float]) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –±–∞–ª–ª—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"""
        return ", ".join([f"{k}: {v}" for k, v in scores.items()])

    def _generate_detailed_test_description(self, test_type: str, scores: Dict[str, float]) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"""
        
        max_score = max(scores, key=scores.get)
        min_score = min(scores, key=scores.get)
        
        if test_type == "PAEI":
            descriptions = {
                "P": "–≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á. –¢–∞–∫–∏–µ –ª—é–¥–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã –≤ —Å–∏—Ç—É–∞—Ü–∏—è—Ö, —Ç—Ä–µ–±—É—é—â–∏—Ö –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–π.",
                "A": "—Å–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫ —Å–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∞—Ü–∏–∏, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é –∏ –∫–æ–Ω—Ç—Ä–æ–ª—é –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑—É—é—Ç —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤ –∫–æ–º–∞–Ω–¥–µ.",
                "E": "–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ, –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º. –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –Ω–æ–≤—ã–µ –∏–¥–µ–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º.",
                "I": "—Ñ–æ–∫—É—Å –Ω–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç–µ, –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –ª—é–¥–µ–π –∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–π —Ä–∞–±–æ—á–µ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã. –û–±—ä–µ–¥–∏–Ω—è—é—Ç –∫–æ–º–∞–Ω–¥—É –∏ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é."
            }
            return f"–î–æ–º–∏–Ω–∏—Ä—É—é—â–∞—è —Ä–æ–ª—å '{max_score}' —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ {descriptions.get(max_score, '–Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É')}. –ú–µ–Ω–µ–µ —Ä–∞–∑–≤–∏—Ç–∞—è —Ä–æ–ª—å '{min_score}' –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è."
        
        elif test_type == "SOFT_SKILLS":
            return f"–ù–∞–∏–±–æ–ª–µ–µ —Ä–∞–∑–≤–∏—Ç—ã–π –Ω–∞–≤—ã–∫ '{max_score}' ({scores[max_score]} –±–∞–ª–ª–æ–≤) —è–≤–ª—è–µ—Ç—Å—è —Å–∏–ª—å–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑–≤–∏–≤–∞—Ç—å '{min_score}' ({scores[min_score]} –±–∞–ª–ª–æ–≤) –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π."
        
        elif test_type == "HEXACO":
            descriptions = {
                "H": "–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —á–µ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ —Å–∫—Ä–æ–º–Ω–æ—Å—Ç–∏ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π –≤ –∫–æ–º–∞–Ω–¥–µ",
                "E": "–†–∞–∑–≤–∏—Ç–∞—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–º–æ–≥–∞–µ—Ç –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ —á—É–≤—Å—Ç–≤ –¥—Ä—É–≥–∏—Ö –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏",
                "X": "–í—ã—Ä–∞–∂–µ–Ω–Ω–∞—è —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–º—É —Å–æ—Ü–∏–∞–ª—å–Ω–æ–º—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é –∏ –ª–∏–¥–µ—Ä—Å—Ç–≤—É",
                "A": "–î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≥–∞—Ä–º–æ–Ω–∏—á–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ",
                "C": "–î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å",
                "O": "–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–ø—ã—Ç—É —Å—Ç–∏–º—É–ª–∏—Ä—É–µ—Ç –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º"
            }
            return f"–í–µ–¥—É—â–∞—è —á–µ—Ä—Ç–∞ '{max_score}' ({scores[max_score]} –±–∞–ª–ª–æ–≤): {descriptions.get(max_score, '—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –ª–∏—á–Ω–æ—Å—Ç–∏')}. –î–ª—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–¥–µ–ª–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ '{min_score}' ({scores[min_score]} –±–∞–ª–ª–æ–≤)."
        
        elif test_type == "DISC":
            descriptions = {
                "D": "—Å–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫ –ø—Ä—è–º–æ–º—É —Å—Ç–∏–ª—é –æ–±—â–µ–Ω–∏—è, –ø—Ä–∏–Ω—è—Ç–∏—é –±—ã—Å—Ç—Ä—ã—Ö —Ä–µ—à–µ–Ω–∏–π –∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç",
                "I": "–≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏, –æ–ø—Ç–∏–º–∏–∑–º –∏ —É–º–µ–Ω–∏–µ –≤–ª–∏—è—Ç—å –Ω–∞ –¥—Ä—É–≥–∏—Ö –ª—é–¥–µ–π",
                "S": "–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, —Ç–µ—Ä–ø–µ–ª–∏–≤–æ—Å—Ç—å –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –∫–æ–º–∞–Ω–¥–Ω—É—é —Ä–∞–±–æ—Ç—É",
                "C": "–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥, –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º –∏ —Å—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–±–æ—Ç–µ"
            }
            return f"–î–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —Å—Ç–∏–ª—å '{max_score}' ({scores[max_score]} –±–∞–ª–ª–æ–≤) —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –∫–∞–∫ {descriptions.get(max_score, '–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å')}. –†–∞–∑–≤–∏—Ç–∏–µ '{min_score}' ({scores[min_score]} –±–∞–ª–ª–æ–≤) –ø–æ–º–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ä–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫—É—é –≥–∏–±–∫–æ—Å—Ç—å."
        
        return "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –æ—Å–Ω–æ–≤—É –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è."

    def upload_to_google_drive(self, file_path: str, participant_name: str = None) -> Optional[str]:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç PDF –æ—Ç—á–µ—Ç –≤ Google Drive –≤ –º–µ—Å—è—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫"""
        if not GOOGLE_DRIVE_AVAILABLE:
            print("‚ö†Ô∏è Google Drive –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞")
            return None
        
        try:
            print("üì§ –ó–∞–≥—Ä—É–∑–∫–∞ PDF –æ—Ç—á–µ—Ç–∞ –≤ Google Drive...")
            
            # –ó–∞–≥—Ä—É–∂–∞–µ–º —Å –º–µ—Å—è—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –ø–∞–ø–æ–∫: PsychTest Reports/2025/10-October
            web_link = upload_to_google_drive_oauth(
                file_path=file_path,
                folder_name="PsychTest Reports",
                use_monthly_structure=True
            )
            
            if web_link:
                print(f"üéâ PDF —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ Google Drive!")
                print(f"üîó –°—Å—ã–ª–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞: {web_link}")
                return web_link
            else:
                print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å PDF –≤ Google Drive")
                return None
                
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Google Drive: {e}")
            return None

    def generate_full_volume_report(self, 
                                   participant_name: str = "–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
                                   test_date: str = None,
                                   paei_scores: Dict[str, float] = None,
                                   disc_scores: Dict[str, float] = None, 
                                   hexaco_scores: Dict[str, float] = None,
                                   soft_skills_scores: Dict[str, float] = None,
                                   ai_interpretations: Dict[str, str] = None,
                                   filename: str = "final_header_numbered_report.pdf",
                                   upload_to_gdrive: bool = True) -> Tuple[str, Optional[str]]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ü–û–õ–ù–´–ô PDF –æ—Ç—á—ë—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π, –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π –∏ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ Google Drive
        
        Returns:
            Tuple[str, Optional[str]]: (–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É, —Å—Å—ã–ª–∫–∞ –Ω–∞ Google Drive –∏–ª–∏ None)
        """
        
        if test_date is None:
            test_date = datetime.now().strftime("%Y-%m-%d")
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –æ–±—ä–µ–º–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        if paei_scores is None:
            paei_scores = {"P": 8, "A": 6, "E": 9, "I": 7}
        if disc_scores is None:
            disc_scores = {"D": 7, "I": 8, "S": 5, "C": 6}
        if hexaco_scores is None:
            hexaco_scores = {"H": 4, "E": 3, "X": 5, "A": 4, "C": 5, "O": 4}
        if soft_skills_scores is None:
            soft_skills_scores = {
                "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ": 8, "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 9, "–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 7, "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞": 6,
                "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å": 8, "–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞": 9, "–≠–º–ø–∞—Ç–∏—è": 7, 
                "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ": 6, "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º": 8, "–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º": 7
            }
        if ai_interpretations is None:
            ai_interpretations = {
                'overall': '–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Å –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–º–∏ –ª–∏–¥–µ—Ä—Å–∫–∏–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞–º–∏ –∏ –≤—ã—Å–æ–∫–∏–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–º –¥–ª—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç—ã. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑–≤–∏—Ç–∏–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤.',
                'paei': '–ü–æ –º–µ—Ç–æ–¥–∏–∫–µ –ê–¥–∏–∑–µ—Å–∞ –≤—ã—è–≤–ª–µ–Ω–∞ —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (E=9) –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é (P=8), —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.',
                'disc': 'DISC –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ –≤–ª–∏—è–Ω–∏—è (I=8) –∏ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (D=7), —á—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –ª–∏–¥–µ—Ä–æ–≤.',
                'hexaco': '–õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å HEXACO –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —É–º–µ—Ä–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –≤—Å–µ–º —Ñ–∞–∫—Ç–æ—Ä–∞–º, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏.',
                'soft_skills': '–ê–Ω–∞–ª–∏–∑ soft skills –≤—ã—è–≤–ª—è–µ—Ç –æ—Å–æ–±—ã–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –≤ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ (9 –±–∞–ª–ª–æ–≤) –∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç–µ (9 –±–∞–ª–ª–æ–≤), —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ —Ü–µ–Ω–Ω—ã–º —á–ª–µ–Ω–æ–º –ª—é–±–æ–π –∫–æ–º–∞–Ω–¥—ã.'
            }
        
        # –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π
        doc = SimpleDocTemplate(
            filename,
            pagesize=A4,
            leftMargin=DesignConfig.MARGIN*mm,
            rightMargin=DesignConfig.MARGIN*mm,
            topMargin=DesignConfig.MARGIN*mm + 20,  # –£–≤–µ–ª–∏—á–µ–Ω–æ –º–µ—Å—Ç–æ –¥–ª—è –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª–∞
            bottomMargin=DesignConfig.MARGIN*mm,
            canvasmaker=FinalNumberedCanvas  # –ò–°–ü–û–õ–¨–ó–£–ï–ú –†–ê–ë–û–ß–ò–ô CANVAS!
        )
        
        # –°—Ç–∏–ª–∏
        styles = self._get_custom_styles()
        story = []
        
        # === –ó–ê–ì–û–õ–û–í–û–ö –î–û–ö–£–ú–ï–ù–¢–ê ===
        story.append(Paragraph("–ö–û–ú–ü–õ–ï–ö–°–ù–ê–Ø –û–¶–ï–ù–ö–ê –ö–û–ú–ê–ù–î–ù–´–• –ù–ê–í–´–ö–û–í", styles['MainTitle']))
        story.append(Spacer(1, 8*mm))
        
        # === –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –¢–ï–°–¢–ò–†–£–ï–ú–û–ú ===
        info_data = [
            ['–ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:', participant_name],
            ['–î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:', test_date],
            ['–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Ç–æ–¥–∏–∫:', '4 (PAEI, DISC, HEXACO, Soft Skills)'],
        ]
        
        info_table = Table(info_data, colWidths=[50*mm, 80*mm])
        info_table.setStyle(TableStyle([
            ('FONT', (0, 0), (-1, -1), DesignConfig.BODY_FONT, 10),
            ('ALIGN', (0, 0), (0, -1), 'LEFT'),
            ('ALIGN', (1, 0), (1, -1), 'LEFT'),
            ('VALIGN', (0, 0), (-1, -1), 'TOP'),
            ('TEXTCOLOR', (0, 0), (0, -1), DesignConfig.PRIMARY_COLOR),
            ('FONTNAME', (0, 0), (0, -1), DesignConfig.TITLE_FONT),
        ]))
        
        story.append(info_table)
        story.append(Spacer(1, 10*mm))
        
        # === –û–ë–©–ï–ï –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï ===
        story.append(Paragraph("–û–ë–©–ï–ï –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò", styles['SectionTitle']))
        story.append(Spacer(1, 5*mm))
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–µ —á–µ—Ä—Ç—ã
        max_paei = max(paei_scores, key=paei_scores.get)
        max_disc = max(disc_scores, key=disc_scores.get)
        max_hexaco = max(hexaco_scores, key=hexaco_scores.get)
        max_soft = max(soft_skills_scores, key=soft_skills_scores.get)
        
        paei_names = {"P": "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å", "A": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä", "E": "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å", "I": "–ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä"}
        disc_names = {"D": "–î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ", "I": "–í–ª–∏—è–Ω–∏–µ", "S": "–ü–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ", "C": "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ"}
        hexaco_full_names = {
            "H": "Honesty-Humility (–ß–µ—Å—Ç–Ω–æ—Å—Ç—å-–°–∫—Ä–æ–º–Ω–æ—Å—Ç—å)",
            "E": "Emotionality (–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)", 
            "X": "eXtraversion (–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è)",
            "A": "Agreeableness (–î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å)",
            "C": "Conscientiousness (–î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å)",
            "O": "Openness (–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–ø—ã—Ç—É)"
        }
        max_hexaco_full_name = hexaco_full_names.get(max_hexaco, max_hexaco)
        
        # –°–∏–Ω—Ç–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        synthesis_text = f"""
        –ù–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ <b>{participant_name}</b> 
        –ø—Ä–æ–≤–µ–¥–µ–Ω –∞–Ω–∞–ª–∏–∑ —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞, –ª–∏—á–Ω–æ—Å—Ç–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π, –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö —Å—Ç–∏–ª–µ–π 
        –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ 
        –æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ñ–∏–ª–µ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–µ —Ä–∞–∑–≤–∏—Ç–∏—è.
        """
        story.append(Paragraph(synthesis_text, styles['Body']))
        story.append(Spacer(1, 5*mm))
        
        # –ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        story.append(Paragraph("<b>–ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥–∏–∫–∏:</b>", styles['SubTitle']))
        
        key_traits_and_methodology = f"""
        <b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</b><br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>–¢–µ—Å—Ç –ê–¥–∏–∑–µ—Å–∞ (PAEI)</b> - –æ—Ü–µ–Ω–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏—Ö —Ä–æ–ª–µ–π –∏ —Å—Ç–∏–ª–µ–π —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ (5 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ 4 —Ç–∏–ø–∞–º). –ü—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç —Ä–æ–ª—å {paei_names.get(max_paei, max_paei)} - {paei_scores[max_paei]} –±–∞–ª–ª–æ–≤<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>–û—Ü–µ–Ω–∫–∞ Soft Skills</b> - –∞–Ω–∞–ª–∏–∑ –Ω–∞–¥–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π (10 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ 10-–±–∞–ª–ª—å–Ω–æ–π —à–∫–∞–ª–µ). –ù–∞–∏–±–æ–ª–µ–µ —Ä–∞–∑–≤–∏—Ç—ã–π –Ω–∞–≤—ã–∫: {max_soft} - {soft_skills_scores[max_soft]} –±–∞–ª–ª–æ–≤<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>HEXACO</b> - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —à–µ—Å—Ç–∏—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –º–æ–¥–µ–ª—å –ª–∏—á–Ω–æ—Å—Ç–∏ (10 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ 5-–±–∞–ª–ª—å–Ω–æ–π —à–∫–∞–ª–µ). {max_hexaco} ‚Äì {max_hexaco_full_name} ({hexaco_scores[max_hexaco]} –±–∞–ª–ª–æ–≤)<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>DISC</b> - –º–µ—Ç–æ–¥–∏–∫–∞ –æ—Ü–µ–Ω–∫–∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –∏ —Å—Ç–∏–ª–µ–π (8 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ 4 —Ç–∏–ø–∞–º). {disc_names.get(max_disc, max_disc)} ({disc_scores[max_disc]} –±–∞–ª–ª–æ–≤)
        """
        story.append(Paragraph(key_traits_and_methodology, styles['Body']))
        story.append(Spacer(1, 10*mm))
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        story.append(Paragraph("<b>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º—É —Ä–∞–∑–≤–∏—Ç–∏—é:</b>", styles['SubTitle']))
        
        paei_genitive = {
            '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å': '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è',
            '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞', 
            '–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å': '–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—è',
            '–ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä': '–ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä–∞'
        }
        
        dominant_paei_role = paei_names.get(max_paei, max_paei)
        
        recommendations = f"""
        <b>1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω:</b><br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ (PAEI): –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ—Ñ–∏–ª—é {dominant_paei_role}<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ (Soft Skills): –†–∞–∑–≤–∏–≤–∞—Ç—å {max_soft.lower()} —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ (DISC): –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å {disc_names.get(max_disc, max_disc).lower()} –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏<br/><br/>
        
        <b>2. –û–±–ª–∞—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:</b><br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ (PAEI): –†–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –º–µ–Ω–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–º–∏ —Ä–æ–ª—è–º–∏<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ (Soft Skills): –†–∞–∑–≤–∏–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ soft skills –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ (DISC): –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏<br/><br/>
        
        <b>3. –ö–∞—Ä—å–µ—Ä–Ω—ã–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã:</b><br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ (PAEI): –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∏—Ü–∏–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –∫–∞—á–µ—Å—Ç–≤ {paei_genitive.get(dominant_paei_role, dominant_paei_role)}<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ (HEXACO): –ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–≤–∏—Ç–∏–µ —Å —É—á–µ—Ç–æ–º –ª–∏—á–Ω–æ—Å—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è HEXACO<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ (DISC): –í—ã—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É —Å —É—á–µ—Ç–æ–º –∫–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã—Ö —Ä–æ–ª–µ–π –ø–æ DISC
        """
        story.append(Paragraph(recommendations, styles['Body']))
        story.append(Spacer(1, 15*mm))
        
        # –ü–µ—Ä–µ—Ö–æ–¥ –∫ –¥–µ—Ç–∞–ª—å–Ω—ã–º —Ä–∞–∑–¥–µ–ª–∞–º
        story.append(PageBreak())
        
        # === –î–ï–¢–ê–õ–¨–ù–´–ï –†–ê–ó–î–ï–õ–´ ===
        
        # 1. –¢–ï–°–¢ –ê–î–ò–ó–ï–°–ê (PAEI)
        story.append(Paragraph("1. –¢–ï–°–¢ –ê–î–ò–ó–ï–°–ê (PAEI) - –£–ü–†–ê–í–õ–ï–ù–ß–ï–°–ö–ò–ï –†–û–õ–ò", styles['UnbreakableTitle']))
        story.append(Spacer(1, 5*mm))
        
        paei_test_description = """
        –¢–µ—Å—Ç –ê–¥–∏–∑–µ—Å–∞ (PAEI) - –æ—Ü–µ–Ω–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏—Ö —Ä–æ–ª–µ–π –∏ —Å—Ç–∏–ª–µ–π —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ (5 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ 4 —Ç–∏–ø–∞–º).
        –ú–µ—Ç–æ–¥–∏–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–∞–∑–≤–∏—Ç–∏—è –≤ —á–µ—Ç—ã—Ä–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö.
        """
        story.append(Paragraph(paei_test_description, styles['Body']))
        story.append(Spacer(1, 5*mm))
        
        # –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ PAEI
        paei_description = """
        <b>–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ PAEI:</b><br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>P (Producer - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å)</b> - –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–µ–π. –§–æ–∫—É—Å –Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>A (Administrator - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</b> - –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –∫–æ–Ω—Ç—Ä–æ–ª—å, —Å–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã. –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏.<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>E (Entrepreneur - –ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å)</b> - –∏–Ω–Ω–æ–≤–∞—Ü–∏–∏, —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ, –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å. –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –∏ —Ä–∞–∑–≤–∏—Ç–∏—é.<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>I (Integrator - –ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä)</b> - –∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –º–æ—Ç–∏–≤–∞—Ü–∏—è –ª—é–¥–µ–π, —Å–æ–∑–¥–∞–Ω–∏–µ –µ–¥–∏–Ω—Å—Ç–≤–∞. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏.
        """
        story.append(Paragraph(paei_description, styles['Body']))
        story.append(Spacer(1, 8*mm))
        
        # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã PAEI
        paei_results = f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</b> {self._format_scores(paei_scores)}"
        story.append(Paragraph(paei_results, styles['Body']))
        story.append(Spacer(1, 5*mm))
        
        # –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ PAEI
        detailed_paei = self._generate_detailed_test_description("PAEI", paei_scores)
        story.append(Paragraph(detailed_paei, styles['Body']))
        story.append(Spacer(1, 3*mm))
        
        # AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è PAEI
        if 'paei' in ai_interpretations:
            story.append(Paragraph("<b>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:</b>", styles['SubTitle']))
            story.append(Paragraph(ai_interpretations['paei'], styles['Body']))
        story.append(Spacer(1, 10*mm))
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è PAEI (—É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ–±—ä–µ–º)
        paei_additional = """
        <b>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ PAEI:</b><br/>
        –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–æ–º–∏–Ω–∏—Ä—É—é—â–µ–π —Ä–æ–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ —Å—Ç–∏–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è. 
        –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã –≤ –ø—Ä–æ–µ–∫—Ç–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å —á–µ—Ç–∫–∏–º–∏ –¥–µ–¥–ª–∞–π–Ω–∞–º–∏. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ 
        —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ–º –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–∏ —Ü–µ–Ω–Ω—ã 
        –≤ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏. –ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä—ã –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏ 
        –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.
        
        –î–ª—è –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –º–µ–Ω–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–º–∏ —Ä–æ–ª—è–º–∏ —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ 
        —Ç—Ä–µ–Ω–∏–Ω–≥–∏, –Ω–∞—Å—Ç–∞–≤–Ω–∏—á–µ—Å—Ç–≤–æ –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∑–æ–Ω—ã –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏. –í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ 
        –∏–¥–µ–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å–æ—á–µ—Ç–∞–µ—Ç –≤—Å–µ —á–µ—Ç—ã—Ä–µ —Ä–æ–ª–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏.
        """
        story.append(Paragraph(paei_additional, styles['Body']))
        story.append(Spacer(1, 10*mm))
        
        # 2. SOFT SKILLS
        story.append(PageBreak())
        story.append(Paragraph("2. –û–¶–ï–ù–ö–ê SOFT SKILLS - –ù–ê–î–ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–´–ï –ö–û–ú–ü–ï–¢–ï–ù–¶–ò–ò", styles['UnbreakableTitle']))
        story.append(Spacer(1, 5*mm))
        
        soft_test_description = """
        –û—Ü–µ–Ω–∫–∞ Soft Skills - –∞–Ω–∞–ª–∏–∑ –Ω–∞–¥–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π (10 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ 10-–±–∞–ª–ª—å–Ω–æ–π —à–∫–∞–ª–µ).
        –î–∞–Ω–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è —É—Å–ø–µ—à–Ω–æ–π –∫–∞—Ä—å–µ—Ä—ã –≤ –ª—é–±–æ–π —Å—Ñ–µ—Ä–µ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
        """
        story.append(Paragraph(soft_test_description, styles['Body']))
        story.append(Spacer(1, 5*mm))
        
        soft_description = """
        <b>Soft Skills</b> - —ç—Ç–æ –Ω–∞–¥–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç —Ä–µ—à–∞—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–µ –∏ —Ä–∞–±–æ—á–∏–µ –∑–∞–¥–∞—á–∏ 
        –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏. –í–∫–ª—é—á–∞—é—Ç –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏, –ª–∏–¥–µ—Ä—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞, –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, 
        –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å. –≠—Ç–∏ –Ω–∞–≤—ã–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ª—é–¥—å–º–∏ 
        –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º—É —Ä–æ—Å—Ç—É –≤ –ª—é–±–æ–π —Å—Ñ–µ—Ä–µ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
        
        –í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ soft skills —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –≤—Å–µ –±–æ–ª–µ–µ –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã–º–∏, —á–∞—Å—Ç–æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏ 
        —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏. –†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–∏ —Ü–µ–Ω—è—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Å–ø–æ—Å–æ–±–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∫–æ–º–º—É–Ω–∏—Ü–∏—Ä–æ–≤–∞—Ç—å, 
        –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –∏ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–µ.
        """
        story.append(Paragraph(soft_description, styles['Body']))
        story.append(Spacer(1, 8*mm))
        
        # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Soft Skills
        soft_results = f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</b> {self._format_scores(soft_skills_scores)}"
        story.append(Paragraph(soft_results, styles['Body']))
        story.append(Spacer(1, 5*mm))
        
        # –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ Soft Skills
        detailed_soft = self._generate_detailed_test_description("SOFT_SKILLS", soft_skills_scores)
        story.append(Paragraph(detailed_soft, styles['Body']))
        story.append(Spacer(1, 3*mm))

        # AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è Soft Skills
        if 'soft_skills' in ai_interpretations:
            story.append(Paragraph("<b>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:</b>", styles['SubTitle']))
            story.append(Paragraph(ai_interpretations['soft_skills'], styles['Body']))

        story.append(Spacer(1, 8*mm))
        
        # –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–º –Ω–∞–≤—ã–∫–µ
        soft_skills_detailed = """
        <b>–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ soft skills:</b><br/>
        ‚Ä¢ <b>–õ–∏–¥–µ—Ä—Å—Ç–≤–æ</b> - —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å –∏ –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –æ–±—â–∏—Ö —Ü–µ–ª–µ–π<br/>
        ‚Ä¢ <b>–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è</b> - —É–º–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥<br/>
        ‚Ä¢ <b>–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å</b> - —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∏–¥–µ–∏ –∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è<br/>
        ‚Ä¢ <b>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</b> - —É–º–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –≤—ã—è–≤–ª—è—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏<br/>
        ‚Ä¢ <b>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</b> - –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ –æ—Å–≤–∞–∏–≤–∞—Ç—å –Ω–æ–≤–æ–µ<br/>
        ‚Ä¢ <b>–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞</b> - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∫–æ–ª–ª–µ–≥–∞–º–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –æ–±—â–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤<br/>
        ‚Ä¢ <b>–≠–º–ø–∞—Ç–∏—è</b> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ —ç–º–æ—Ü–∏–π –¥—Ä—É–≥–∏—Ö –ª—é–¥–µ–π –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ —Å–æ–ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—é<br/>
        ‚Ä¢ <b>–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ</b> - –æ–±—ä–µ–∫—Ç–∏–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π<br/>
        ‚Ä¢ <b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º</b> - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤<br/>
        ‚Ä¢ <b>–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º</b> - —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –∫ –ø–æ–∏—Å–∫—É –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ—à–µ–Ω–∏–π —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á
        """
        story.append(Paragraph(soft_skills_detailed, styles['Body']))
        story.append(Spacer(1, 10*mm))
        
        # 3. HEXACO
        story.append(PageBreak())
        story.append(Paragraph("3. HEXACO - –°–û–í–†–ï–ú–ï–ù–ù–ê–Ø –®–ï–°–¢–ò–§–ê–ö–¢–û–†–ù–ê–Ø –ú–û–î–ï–õ–¨ –õ–ò–ß–ù–û–°–¢–ò", styles['UnbreakableTitle']))
        story.append(Spacer(1, 5*mm))
        
        hexaco_test_description = """
        HEXACO - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —à–µ—Å—Ç–∏—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –º–æ–¥–µ–ª—å –ª–∏—á–Ω–æ—Å—Ç–∏ (10 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ 5-–±–∞–ª–ª—å–Ω–æ–π —à–∫–∞–ª–µ).
        –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–∞–∑–≤–∏—Ç–∏–µ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –ë–æ–ª—å—à–æ–π –ü—è—Ç–µ—Ä–∫–∏ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Ñ–∞–∫—Ç–æ—Ä–∞ –ß–µ—Å—Ç–Ω–æ—Å—Ç–∏-–°–∫—Ä–æ–º–Ω–æ—Å—Ç–∏.
        """
        story.append(Paragraph(hexaco_test_description, styles['Body']))
        story.append(Spacer(1, 5*mm))
        
        hexaco_description = """
        <b>–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ HEXACO:</b><br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>H (Honesty-Humility)</b> - —á–µ—Å—Ç–Ω–æ—Å—Ç—å, —Å–∫—Ä–æ–º–Ω–æ—Å—Ç—å, –∏—Å–∫—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö. –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —ç—Ç–∏—á–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>E (Emotionality)</b> - —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —ç–º–ø–∞—Ç–∏—è. –í–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>X (eXtraversion)</b> - —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è, —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –æ–±—â–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∏–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>A (Agreeableness)</b> - –¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ, —Ç–µ—Ä–ø–∏–º–æ—Å—Ç—å. –í–∞–∂–Ω–æ –¥–ª—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç—ã.<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>C (Conscientiousness)</b> - –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞. –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–±–æ—á—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>O (Openness)</b> - –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–ø—ã—Ç—É, –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –°–≤—è–∑–∞–Ω–æ —Å –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–º.
        """
        story.append(Paragraph(hexaco_description, styles['Body']))
        story.append(Spacer(1, 8*mm))
        
        # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã HEXACO
        hexaco_results = f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</b> {self._format_scores(hexaco_scores)}"
        story.append(Paragraph(hexaco_results, styles['Body']))
        story.append(Spacer(1, 5*mm))
        
        # –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ HEXACO
        detailed_hexaco = self._generate_detailed_test_description("HEXACO", hexaco_scores)
        story.append(Paragraph(detailed_hexaco, styles['Body']))
        story.append(Spacer(1, 3*mm))
        
        # AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è HEXACO
        if 'hexaco' in ai_interpretations:
            story.append(Paragraph("<b>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:</b>", styles['SubTitle']))
            story.append(Paragraph(ai_interpretations['hexaco'], styles['Body']))
        story.append(Spacer(1, 8*mm))
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ HEXACO
        hexaco_additional = """
        <b>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ HEXACO –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:</b><br/>
        –ú–æ–¥–µ–ª—å HEXACO –æ—Å–æ–±–µ–Ω–Ω–æ —Ü–µ–Ω–Ω–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞. 
        –í—ã—Å–æ–∫–∞—è —á–µ—Å—Ç–Ω–æ—Å—Ç—å-—Å–∫—Ä–æ–º–Ω–æ—Å—Ç—å —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —ç—Ç–∏—á–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤ –¥–µ–ª–æ–≤—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö. 
        –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ —Å—Ç—Ä–µ—Å—Å–æ–º –∏ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö. 
        –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –≤ —Ä–∞–±–æ—á–µ–π —Å—Ä–µ–¥–µ –∏ —Å—Ç–∏–ª–µ –ª–∏–¥–µ—Ä—Å—Ç–≤–∞.
        
        –î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ –¥–ª—è —Ä–æ–ª–µ–π, —Ç—Ä–µ–±—É—é—â–∏—Ö –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ª—é–¥—å–º–∏. 
        –î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –ª—É—á—à–∏—Ö –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–≤ —Ä–∞–±–æ—á–µ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–æ –≤—Å–µ—Ö —Å—Ñ–µ—Ä–∞—Ö. 
        –û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–ø—ã—Ç—É –æ—Å–æ–±–µ–Ω–Ω–æ —Ü–µ–Ω–Ω–∞ –≤ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã—Ö –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
        """
        story.append(Paragraph(hexaco_additional, styles['Body']))
        story.append(Spacer(1, 10*mm))
        
        # 4. DISC
        story.append(PageBreak())
        story.append(Paragraph("4. DISC - –ú–ï–¢–û–î–ò–ö–ê –û–¶–ï–ù–ö–ò –ü–û–í–ï–î–ï–ù–ß–ï–°–ö–ò–• –û–°–û–ë–ï–ù–ù–û–°–¢–ï–ô –ò –°–¢–ò–õ–ï–ô", styles['UnbreakableTitle']))
        story.append(Spacer(1, 5*mm))
        
        disc_test_description = """
        DISC - –º–µ—Ç–æ–¥–∏–∫–∞ –æ—Ü–µ–Ω–∫–∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –∏ —Å—Ç–∏–ª–µ–π (8 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ 4 —Ç–∏–ø–∞–º).
        –û–¥–Ω–∞ –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–∏–∫ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–∏–ª—è –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –≤ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏.
        """
        story.append(Paragraph(disc_test_description, styles['Body']))
        story.append(Spacer(1, 5*mm))
        
        disc_description = """
        <b>–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ DISC:</b><br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>D (Dominance)</b> - –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä—è–º–æ—Ç–∞, —Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç –±—ã—Å—Ç—Ä—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å.<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>I (Influence)</b> - –≤–ª–∏—è–Ω–∏–µ, –æ–±—â–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ–ø—Ç–∏–º–∏–∑–º, –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –ª—é–¥–µ–π. –ú–æ—Ç–∏–≤–∏—Ä—É—é—Ç –¥—Ä—É–≥–∏—Ö –∏ —Å–æ–∑–¥–∞—é—Ç –ø–æ–∑–∏—Ç–∏–≤–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É.<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>S (Steadiness)</b> - –ø–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ, —Ç–µ—Ä–ø–µ–Ω–∏–µ, –∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å. –¶–µ–Ω—è—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â—É—é —Å—Ä–µ–¥—É.<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ <b>C (Compliance)</b> - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º, –∞–Ω–∞–ª–∏—Ç–∏—á–Ω–æ—Å—Ç—å, —Ç–æ—á–Ω–æ—Å—Ç—å, –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å. –§–æ–∫—É—Å–∏—Ä—É—é—Ç—Å—è –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏.
        """
        story.append(Paragraph(disc_description, styles['Body']))
        story.append(Spacer(1, 8*mm))
        
        # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã DISC
        disc_results = f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</b> {self._format_scores(disc_scores)}"
        story.append(Paragraph(disc_results, styles['Body']))
        story.append(Spacer(1, 5*mm))
        
        # –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ DISC
        detailed_disc = self._generate_detailed_test_description("DISC", disc_scores)
        story.append(Paragraph(detailed_disc, styles['Body']))
        story.append(Spacer(1, 3*mm))
        
        # AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è DISC
        if 'disc' in ai_interpretations:
            story.append(Paragraph("<b>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:</b>", styles['SubTitle']))
            story.append(Paragraph(ai_interpretations['disc'], styles['Body']))
        
        story.append(Spacer(1, 8*mm))
        
        # –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ DISC
        disc_practical = """
        <b>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ —Å—Ç–∏–ª—è DISC:</b><br/>
        <b>–î–ª—è —Ä–∞–±–æ—Ç—ã —Å D-—Ç–∏–ø–æ–º:</b> –±—É–¥—å—Ç–µ –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω—ã, —Ñ–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö, –∏–∑–±–µ–≥–∞–π—Ç–µ –¥–æ–ª–≥–∏—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏–π.<br/>
        <b>–î–ª—è —Ä–∞–±–æ—Ç—ã —Å I-—Ç–∏–ø–æ–º:</b> –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–Ω—Ç—É–∑–∏–∞–∑–º, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.<br/>
        <b>–î–ª—è —Ä–∞–±–æ—Ç—ã —Å S-—Ç–∏–ø–æ–º:</b> –æ–±–µ—Å–ø–µ—á–∏–≤–∞–π—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –¥–∞–≤–∞–π—Ç–µ –≤—Ä–µ–º—è –Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏—é –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º.<br/>
        <b>–î–ª—è —Ä–∞–±–æ—Ç—ã —Å C-—Ç–∏–ø–æ–º:</b> –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –æ–±–µ—Å–ø–µ—á–∏–≤–∞–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.
        
        –ü–æ–Ω–∏–º–∞–Ω–∏–µ DISC-–ø—Ä–æ—Ñ–∏–ª—è –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏, –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á 
        –∏ –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥—ã, —á—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã.
        """
        story.append(Paragraph(disc_practical, styles['Body']))
        story.append(Spacer(1, 10*mm))
        
        # === –ò–¢–û–ì–û–í–´–ï –í–´–í–û–î–´ ===
        if 'overall' in ai_interpretations:
            story.append(PageBreak())
            story.append(Paragraph("–ò–¢–û–ì–û–í–´–ï –í–´–í–û–î–´ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò", styles['SectionTitle']))
            story.append(Spacer(1, 5*mm))
            story.append(Paragraph(ai_interpretations['overall'], styles['Body']))
            story.append(Spacer(1, 8*mm))
            
            # –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
            final_recommendations = """
            <b>–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è:</b><br/>
            1. <b>–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞ (1-3 –º–µ—Å—è—Ü–∞):</b> –°—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–∏ –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –∏ –∑–∞–¥–∞—á–∏.<br/>
            2. <b>–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞ (3-12 –º–µ—Å—è—Ü–µ–≤):</b> –†–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ —Ä–∞–∑–≤–∏—Ç–∏–µ–º –º–µ–Ω–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π —á–µ—Ä–µ–∑ –æ–±—É—á–µ–Ω–∏–µ –∏ –ø—Ä–∞–∫—Ç–∏–∫—É.<br/>
            3. <b>–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞ (1-3 –≥–æ–¥–∞):</b> –ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç —Å —É—á–µ—Ç–æ–º –≤—ã—è–≤–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ —Ä–∞–∑–≤–∏—Ç–∏—è.
            
            –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ü–µ–ª–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ä–∞–∑–≤–∏—Ç–∏–µ–º –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π 
            –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ —Ä–∞–±–æ—á–µ–π —Å—Ä–µ–¥–µ. –í–∞–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ–º –Ω–æ–≤—ã—Ö –Ω–∞–≤—ã–∫–æ–≤.
            """
            story.append(Paragraph(final_recommendations, styles['Body']))
        
        # –°—Ç—Ä–æ–∏–º –¥–æ–∫—É–º–µ–Ω—Ç
        print("üîÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ PDF –æ—Ç—á–µ—Ç–∞ —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π...")
        doc.build(story)
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –≤ Google Drive (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
        google_drive_link = None
        if upload_to_gdrive:
            google_drive_link = self.upload_to_google_drive(filename, participant_name)
        
        return filename, google_drive_link

if __name__ == "__main__":
    try:
        generator = FinalFullVolumeGenerator()
        result_file, google_drive_link = generator.generate_full_volume_report()
        
        print(f"‚úÖ –°–æ–∑–¥–∞–Ω –§–ò–ù–ê–õ–¨–ù–´–ô PDF: {result_file}")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä
        size = os.path.getsize(result_file)
        size_kb = size / 1024
        print(f"üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {size} –±–∞–π—Ç ({size_kb:.1f} KB)")
        
        if size > 50000:  # –ë–æ–ª—å—à–µ 50KB
            print("‚úÖ –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª–Ω–æ–º—É –æ–±—ä–µ–º—É")
            print("‚úÖ –ù—É–º–µ—Ä–∞—Ü–∏—è: '–°—Ç—Ä. X –∏–∑ N' –≤ –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª–µ")
            print("‚úÖ –ö–æ–¥–∏—Ä–æ–≤–∫–∞: Arial —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã")
        else:
            print("‚ö†Ô∏è –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –º–µ–Ω—å—à–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç Google Drive
        if google_drive_link:
            print(f"‚úÖ Google Drive: {google_drive_link}")
        else:
            print("‚ö†Ô∏è Google Drive: –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞")
            
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        import traceback
        traceback.print_exc()

def create_psychological_report(participant_name: str, 
                              paei_scores: Dict[str, float] = None,
                              disc_scores: Dict[str, float] = None,
                              hexaco_scores: Dict[str, float] = None,
                              soft_skills_scores: Dict[str, float] = None,
                              upload_to_google_drive: bool = True) -> Tuple[str, Optional[str]]:
    """
    –£–¥–æ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—á–µ—Ç–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ Google Drive
    
    Args:
        participant_name: –ò–º—è —É—á–∞—Å—Ç–Ω–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        paei_scores: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã PAEI —Ç–µ—Å—Ç–∞ (–µ—Å–ª–∏ None, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)
        disc_scores: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã DISC —Ç–µ—Å—Ç–∞ (–µ—Å–ª–∏ None, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)
        hexaco_scores: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã HEXACO —Ç–µ—Å—Ç–∞ (–µ—Å–ª–∏ None, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)
        soft_skills_scores: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Soft Skills —Ç–µ—Å—Ç–∞ (–µ—Å–ª–∏ None, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)
        upload_to_google_drive: –ó–∞–≥—Ä—É–∂–∞—Ç—å –ª–∏ –≤ Google Drive (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é True)
    
    Returns:
        Tuple[str, Optional[str]]: (–ø—É—Ç—å –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Ñ–∞–π–ª—É, —Å—Å—ã–ª–∫–∞ –Ω–∞ Google Drive –∏–ª–∏ None)
        
    Example:
        # –°–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        file_path, gdrive_link = create_psychological_report("–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤")
        
        # –°–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
        file_path, gdrive_link = create_psychological_report(
            "–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞",
            paei_scores={"P": 9, "A": 7, "E": 8, "I": 6},
            disc_scores={"D": 8, "I": 9, "S": 6, "C": 5}
        )
    """
    
    # –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–º–µ–Ω–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏ –≤—Ä–µ–º–µ–Ω–∏
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    safe_name = "".join(c for c in participant_name if c.isalnum() or c in (' ', '-', '_')).rstrip()
    safe_name = safe_name.replace(' ', '_')
    filename = f"report_{safe_name}_{timestamp}.pdf"
    
    # –°–æ–∑–¥–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
    generator = FinalFullVolumeGenerator()
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
    return generator.generate_full_volume_report(
        participant_name=participant_name,
        paei_scores=paei_scores,
        disc_scores=disc_scores,
        hexaco_scores=hexaco_scores,
        soft_skills_scores=soft_skills_scores,
        filename=filename,
        upload_to_gdrive=upload_to_google_drive
    )