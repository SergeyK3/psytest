#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–¢–µ—Å—Ç —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ PDF –æ—Ç—á–µ—Ç–∞ –≤–µ—Ä—Å–∏–∏ 2.0 —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
"""

from pathlib import Path
from enhanced_pdf_report_v2 import EnhancedPDFReportV2
from test_scenarios import TEST_SCENARIOS

def test_enhanced_pdf_v2():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ PDF –æ—Ç—á–µ—Ç–∞ v2.0"""
    
    # –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    output_dir = Path("test_pdf_v2_output")
    output_dir.mkdir(exist_ok=True)
    
    # –ë–µ—Ä–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π
    scenario = TEST_SCENARIOS["manager_leader"]
    print(f"üéØ –°–æ–∑–¥–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ PDF –æ—Ç—á–µ—Ç–∞ v2.0 –¥–ª—è: {scenario['name']}")
    
    # –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –æ—Ç—á–µ—Ç–æ–≤
    pdf_generator = EnhancedPDFReportV2(template_dir=output_dir / "temp_charts_v2")
    
    # –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    report_data = {
        "name": scenario["name"].split(" (")[0],  # –£–±–∏—Ä–∞–µ–º —Ç–∏–ø–∞–∂ –∏–∑ –∏–º–µ–Ω–∏
        "paei_scores": scenario["paei_scores"],
        "disc_scores": scenario["disc_scores"], 
        "hexaco_scores": scenario["hexaco_scores"],
        "ai_interpretations": {
            "paei": """–Ø—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π Producer (–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å) —Å —Å–∏–ª—å–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –Ω–∞–≤—ã–∫–∞–º–∏. 
                      –û—Ç–ª–∏—á–∞–µ—Ç—Å—è –≤—ã—Å–æ–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é –∫ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é. –î–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å 
                      —Ö–∞—Ä–∞–∫—Ç–µ—Ä–µ–Ω –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–≤–µ–Ω–∞, —Å–ø–æ—Å–æ–±–Ω—ã—Ö –∫–∞–∫ –¥–æ—Å—Ç–∏–≥–∞—Ç—å —Ü–µ–ª–µ–π, 
                      —Ç–∞–∫ –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑–≤–∏–≤–∞—Ç—å –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏–µ 
                      –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ –¥–ª—è —Ä–æ—Å—Ç–∞ –¥–æ —Ç–æ–ø-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞.""",
            "disc": """–î–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —Ç–∏–ø —Å –≤—ã—Å–æ–∫–æ–π –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–µ–π –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. 
                      –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –ø—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ –∏ –±—ã—Å—Ç—Ä–æ–µ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π. –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —É—Å–ª–æ–≤–∏—è—Ö 
                      –≤—ã–∑–æ–≤–æ–≤ –∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏. –ú–æ–∂–µ—Ç –ø—Ä–æ—è–≤–ª—è—Ç—å –Ω–µ—Ç–µ—Ä–ø–µ–ª–∏–≤–æ—Å—Ç—å –∫ –º–µ–¥–ª–µ–Ω–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º. 
                      –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑–≤–∏–≤–∞—Ç—å —Ç–µ—Ä–ø–µ–Ω–∏–µ –∏ –Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –ª—é–¥—å–º–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è 
                      —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.""",
            "hexaco": """–í—ã—Å–æ–∫–∞—è –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å –∏ —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É—é—Ç –æ–± –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ 
                        –∏ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –∫ –Ω–æ–≤–æ–º—É –æ–ø—ã—Ç—É —Å–æ—á–µ—Ç–∞–µ—Ç—Å—è —Å –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–º 
                        –ø–æ–¥—Ö–æ–¥–æ–º –∫ –∑–∞–¥–∞—á–∞–º. –£–º–µ—Ä–µ–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≥–æ–≤–æ—Ä–∏—Ç –æ —Å—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏. 
                        –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—è—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π, —Ç—Ä–µ–±—É—é—â–∏—Ö –±–∞–ª–∞–Ω—Å–∞ –º–µ–∂–¥—É –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º–∏ 
                        –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å—é."""
        }
    }
    
    # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ soft skills –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è
    soft_skills = {
        "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 8,
        "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ": 9,
        "–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ": 7,
        "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å": 6,
        "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞": 8,
        "–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ": 5
    }
    
    # –°–æ–∑–¥–∞–µ–º PDF –æ—Ç—á–µ—Ç
    output_path = output_dir / f"enhanced_report_v2_{scenario['name'].split()[0].lower()}.pdf"
    
    try:
        pdf_generator.generate_enhanced_report(
            participant_name=report_data["name"],
            test_date="2025-01-25",
            paei_scores=report_data["paei_scores"],
            disc_scores=report_data["disc_scores"],
            hexaco_scores=report_data["hexaco_scores"],
            soft_skills_scores=soft_skills,
            ai_interpretations=report_data["ai_interpretations"],
            out_path=output_path
        )
        
        print(f"‚úÖ PDF –æ—Ç—á–µ—Ç v2.0 —Å–æ–∑–¥–∞–Ω: {output_path}")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ñ–∞–π–ª–∞
        if output_path.exists():
            size_kb = output_path.stat().st_size / 1024
            print(f"üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {size_kb:.1f} KB")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
        temp_charts_dir = output_dir / "temp_charts_v2"
        if temp_charts_dir.exists():
            chart_files = list(temp_charts_dir.glob("*.png"))
            print(f"üìà –°–æ–∑–¥–∞–Ω–æ –¥–∏–∞–≥—Ä–∞–º–º: {len(chart_files)}")
            for chart in chart_files:
                print(f"   - {chart.name}")
        
        print("\nüéâ –¢–µ—Å—Ç PDF –æ—Ç—á–µ—Ç–∞ v2.0 –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!")
        print("üìã –£–ª—É—á—à–µ–Ω–∏—è –≤ v2.0:")
        print("   ‚úÖ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –ê–¥–∏–∑–µ—Å ‚Üí Soft Skills ‚Üí HEXACO ‚Üí DISC")
        print("   ‚úÖ –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä PAEI")
        print("   ‚úÖ –í—Å–µ –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞–¥–∞—Ä–Ω—ã–µ (–≤–∫–ª—é—á–∞—è Soft Skills)")
        print("   ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞")
        print("   ‚úÖ –£–±—Ä–∞–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ OpenAI")
        print("   ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏")
        print(f"üí° –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª {output_path} –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PDF: {e}")
        import traceback
        traceback.print_exc()

if __name__ == "__main__":
    test_enhanced_pdf_v2()