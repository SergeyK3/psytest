#!/usr/bin/env python3
"""
–ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞ —Å –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –∫–æ–º–∞–Ω–¥–µ
"""

import os
import sys
from pathlib import Path
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()

# –î–æ–±–∞–≤–ª—è–µ–º src –≤ –ø—É—Ç—å
sys.path.append(str(Path(__file__).parent / 'src'))

from src.psytest.ai_interpreter import AIInterpreter

def test_full_team_recommendations():
    """–ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –∫–æ–º–∞–Ω–¥–µ"""
    
    print("üß™ –ü–û–õ–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô –ü–û –ö–û–ú–ê–ù–î–ï")
    print("=" * 60)
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä
    try:
        ai = AIInterpreter()
        print("‚úÖ AI –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ AI: {e}")
        return False
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —è–≤–Ω—ã–º–∏ —Å–ª–∞–±—ã–º–∏ –æ–±–ª–∞—Å—Ç—è–º–∏
    test_scores = {
        'paei': {'P': 1, 'A': 1, 'E': 5, 'I': 4},  # P –∏ A - –æ—á–µ–Ω—å —Å–ª–∞–±—ã–µ
        'disc': {'D': 5.0, 'I': 4.0, 'S': 1.0, 'C': 2.0},  # S –æ—á–µ–Ω—å —Å–ª–∞–±—ã–π, C —Å–ª–∞–±—ã–π
        'hexaco': {
            '–ß–µ—Å—Ç–Ω–æ—Å—Ç—å-–°–∫—Ä–æ–º–Ω–æ—Å—Ç—å': 4.0,
            '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å': 1.5,      # –û—á–µ–Ω—å —Å–ª–∞–±–∞—è
            '–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è': 1.2,         # –û—á–µ–Ω—å —Å–ª–∞–±–∞—è  
            '–î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å': 2.0,   # –°–ª–∞–±–∞—è
            '–î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å': 4.5,
            '–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–ø—ã—Ç—É': 3.8
        },
        'soft_skills': {
            'leadership': 5,
            'emotional_intelligence': 5, 
            'communication': 4,
            'critical_thinking': 1,      # –û—á–µ–Ω—å —Å–ª–∞–±—ã–π
            'time_management': 4,
            'conflict_resolution': 5,
            'adaptability': 2,           # –°–ª–∞–±—ã–π
            'employee_development': 5,
            'teamwork': 2,               # –°–ª–∞–±—ã–π
            'creativity': 1              # –û—á–µ–Ω—å —Å–ª–∞–±—ã–π
        }
    }
    
    print("üìä –¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å:")
    print("PAEI —Å–ª–∞–±—ã–µ –æ–±–ª–∞—Å—Ç–∏: P=1, A=1")
    print("DISC —Å–ª–∞–±—ã–µ –æ–±–ª–∞—Å—Ç–∏: S=1.0, C=2.0") 
    print("HEXACO —Å–ª–∞–±—ã–µ –æ–±–ª–∞—Å—Ç–∏: –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å=1.5, –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è=1.2, –î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å=2.0")
    print("Soft Skills —Å–ª–∞–±—ã–µ –æ–±–ª–∞—Å—Ç–∏: critical_thinking=1, adaptability=2, teamwork=2, creativity=1")
    print()
    
    try:
        print("üîÑ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ–±—â–µ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ –∫–æ–º–∞–Ω–¥–µ...")
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ–±—â–µ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ
        general_conclusion = ai.interpret_general_conclusion(test_scores)
        
        print("‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!")
        print()
        print("üìÑ –†–ï–ó–£–õ–¨–¢–ê–¢ –û–ë–©–ï–ì–û –ó–ê–ö–õ–Æ–ß–ï–ù–ò–Ø:")
        print("=" * 50)
        print(general_conclusion)
        print("=" * 50)
        
        # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        content_lower = general_conclusion.lower()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
        team_checks = {
            "–†–∞–∑–¥–µ–ª 4 –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç": "4." in general_conclusion and ("—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–¥–±–æ—Ä—É" in content_lower or "–∫–æ–º–∞–Ω–¥" in content_lower),
            "DISC-–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è": "disc" in content_lower and ("–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è" in content_lower or "–±–∞–ª–∞–Ω—Å" in content_lower),
            "PAEI-–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ": "paei" in content_lower and ("–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ" in content_lower or "—Ä–æ–ª–∏" in content_lower),
            "HEXACO-–±–∞–ª–∞–Ω—Å": "hexaco" in content_lower and ("–±–∞–ª–∞–Ω—Å" in content_lower or "—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫" in content_lower),
            "Soft Skills-—Å–∏–Ω–µ—Ä–≥–∏—è": ("soft skills" in content_lower or "–Ω–∞–≤—ã–∫" in content_lower) and ("—Å–∏–Ω–µ—Ä–≥–∏—è" in content_lower or "—ç–∫—Å–ø–µ—Ä—Ç" in content_lower),
            "–ê–Ω–∞–ª–∏–∑ —Å–ª–∞–±—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π": any(weak in content_lower for weak in ["—Å–ª–∞–±", "–Ω–∏–∑–∫", "—Ä–∞–∑–≤–∏—Ç", "—É–ª—É—á—à"]),
            "–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏": any(rec in content_lower for rec in ["—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç", "–∫–∞–Ω–¥–∏–¥–∞—Ç", "–¥–æ–±–∞–≤–∏—Ç—å", "–∏—Å–∫–∞—Ç—å", "–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å"]),
            "–£–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã": any(team in content_lower for team in ["–∫–æ–º–∞–Ω–¥", "–ø–æ–¥–±–æ—Ä", "–∫–∞–¥—Ä"])
        }
        
        print("\nüîç –ê–ù–ê–õ–ò–ó –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–ò:")
        passed_checks = 0
        for check_name, result in team_checks.items():
            status = "‚úÖ" if result else "‚ùå"
            print(f"{status} {check_name}")
            if result:
                passed_checks += 1
        
        success_rate = passed_checks / len(team_checks) * 100
        print(f"\nüìä –£—Å–ø–µ—à–Ω–æ—Å—Ç—å: {passed_checks}/{len(team_checks)} ({success_rate:.1f}%)")
        
        if success_rate >= 75:
            print("\nüéâ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù! –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ!")
            return True
        elif success_rate >= 50:
            print("\n‚ö†Ô∏è  –¢–ï–°–¢ –ß–ê–°–¢–ò–ß–ù–û –ü–†–û–ô–î–ï–ù. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞.")
            return True
        else:
            print("\nüí• –¢–ï–°–¢ –ü–†–û–í–ê–õ–ï–ù. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.")
            return False
            
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–∞–∫–ª—é—á–µ–Ω–∏—è: {e}")
        return False

if __name__ == "__main__":
    success = test_full_team_recommendations()
    
    if success:
        print("\nüöÄ –ì–û–¢–û–í –ö –ö–û–ú–ú–ò–¢–£: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –∫–æ–º–∞–Ω–¥–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!")
    else:
        print("\nüîß –¢–†–ï–ë–£–ï–¢–°–Ø –î–û–†–ê–ë–û–¢–ö–ê: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –ø—Ä–æ–º–ø—Ç—ã.")