#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã PAEI
"""

from pathlib import Path
from datetime import datetime
from enhanced_pdf_report_v2 import EnhancedPDFReportV2

def create_demo_report():
    """–°–æ–∑–¥–∞–µ—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –æ—Ç—á–µ—Ç —Å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º–æ–π PAEI"""
    
    print("üéØ –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ —Å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º–æ–π PAEI...")
    
    # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —è—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–º –ø—Ä–æ—Ñ–∏–ª–µ–º
    demo_data = {
        "participant_name": "–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –û—Ç—á–µ—Ç",
        "test_date": datetime.now().strftime("%d.%m.%Y"),
        
        # PAEI: –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π –ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å
        "paei_scores": {
            "P": 2,  # –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å - –Ω–∏–∑–∫–∏–π
            "A": 1,  # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä - –æ—á–µ–Ω—å –Ω–∏–∑–∫–∏–π  
            "E": 5,  # –ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π
            "I": 3   # –ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä - —Å—Ä–µ–¥–Ω–∏–π
        },
        
        # DISC: —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
        "disc_scores": {
            "D": 6,  # –î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
            "I": 7,  # –í–ª–∏—è–Ω–∏–µ  
            "S": 4,  # –ü–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ
            "C": 5   # –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
        },
        
        # HEXACO: –≤—ã—Å–æ–∫–∞—è —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è –∏ –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å
        "hexaco_scores": {
            "H": 3.8,  # –ß–µ—Å—Ç–Ω–æ—Å—Ç—å-–°–∫—Ä–æ–º–Ω–æ—Å—Ç—å
            "E": 2.5,  # –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
            "X": 4.7,  # –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è - –≤—ã—Å–æ–∫–∞—è
            "A": 3.9,  # –î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
            "C": 4.1,  # –î–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å  
            "O": 4.5   # –û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ–ø—ã—Ç—É - –≤—ã—Å–æ–∫–∞—è
        },
        
        # Soft Skills: –ª–∏–¥–µ—Ä—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏
        "soft_skills_scores": {
            "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ": 8,
            "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç": 7,
            "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 9,
            "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ": 6,
            "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º": 5,
            "–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤": 7,
            "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å": 8,
            "–†–∞–∑–≤–∏—Ç–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤": 6
        },
        
        # –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ò–ò –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏
        "ai_interpretations": {
            "paei": "–Ø—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏–π —Ç–∏–ø —Å –≤—ã—Å–æ–∫–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–µ–π –Ω–∞ –∏–Ω–Ω–æ–≤–∞—Ü–∏–∏ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è. –°–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–º—É –º—ã—à–ª–µ–Ω–∏—é –∏ –ø–æ–∏—Å–∫—É –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.",
            "disc": "–í—ã—Å–æ–∫–∏–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤–ª–∏—è—Ç—å –Ω–∞ –ª—é–¥–µ–π –∏ –≤–µ—Å—Ç–∏ –∏—Ö –∑–∞ —Å–æ–±–æ–π –≤ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–π.",
            "hexaco": "–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Ç–Ω—ã–π, –æ—Ç–∫—Ä—ã—Ç—ã–π –∫ –Ω–æ–≤–æ–º—É –æ–ø—ã—Ç—É —á–µ–ª–æ–≤–µ–∫ —Å –≤—ã—Å–æ–∫–æ–π –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ—Å—Ç—å—é. –£–º–µ—Ä–µ–Ω–Ω–∞—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ —Ö–æ—Ä–æ—à–∞—è –¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å.",
            "soft_skills": "–†–∞–∑–≤–∏—Ç—ã–µ –ª–∏–¥–µ—Ä—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Å –æ—Å–æ–±–æ —Å–∏–ª—å–Ω—ã–º–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–º–∏ –Ω–∞–≤—ã–∫–∞–º–∏. –í—ã—Å–æ–∫–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∏–∑–º–µ–Ω—è—é—â–∏—Ö—Å—è —É—Å–ª–æ–≤–∏—è—Ö.",
            "general": """
            –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—ã—è–≤–ª—è–µ—Ç —Å–∏–ª—å–Ω—ã–π –ª–∏–¥–µ—Ä—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Å –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏–º –º—ã—à–ª–µ–Ω–∏–µ–º. 
            
            –ß–µ–ª–æ–≤–µ–∫ –æ–±–ª–∞–¥–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —Å–æ—á–µ—Ç–∞–Ω–∏–µ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–∏–¥–µ–Ω–∏—è (E-–¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ PAEI) –∏ 
            –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã—Ö –Ω–∞–≤—ã–∫–æ–≤ (–≤—ã—Å–æ–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –≤ Soft Skills). 
            
            –í—ã—Å–æ–∫–∞—è —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è –∏ –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –∫ –æ–ø—ã—Ç—É (HEXACO) –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å –≤–ª–∏—è–Ω–∏–µ–º –∏ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º (DISC) 
            —Å–æ–∑–¥–∞—é—Ç –ø—Ä–æ—Ñ–∏–ª—å –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ª–∏–¥–µ—Ä–∞, —Å–ø–æ—Å–æ–±–Ω–æ–≥–æ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –∞–º–±–∏—Ü–∏–æ–∑–Ω—ã—Ö —Ü–µ–ª–µ–π.
            
            –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ä–æ–ª–µ–π, —Ç—Ä–µ–±—É—é—â–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –∏ 
            —Ä–∞–∑–≤–∏—Ç–∏—è –Ω–æ–≤—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –±–∏–∑–Ω–µ—Å–∞.
            """
        }
    }
    
    # –°–æ–∑–¥–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤
    pdf_generator = EnhancedPDFReportV2()
    
    # –ü—É—Ç—å –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
    output_path = Path("DEMO_PAEI_Combined_Chart.pdf")
    
    try:
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
        result_path = pdf_generator.generate_enhanced_report(
            participant_name=demo_data["participant_name"],
            test_date=demo_data["test_date"],
            paei_scores=demo_data["paei_scores"],
            disc_scores=demo_data["disc_scores"],
            hexaco_scores=demo_data["hexaco_scores"],
            soft_skills_scores=demo_data["soft_skills_scores"],
            ai_interpretations=demo_data["ai_interpretations"],
            out_path=output_path
        )
        
        if result_path.exists():
            size_kb = result_path.stat().st_size / 1024
            print(f"‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π PDF —Å–æ–∑–¥–∞–Ω: {result_path}")
            print(f"üìÑ –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {size_kb:.1f} KB")
            
            # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö
            print(f"\nüé® –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ –æ—Ç—á–µ—Ç–µ:")
            print(f"‚úÖ –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ PAEI (—Å—Ç–æ–ª–±–∏–∫–æ–≤–∞—è + –ø–∏—Ä–æ–≥–æ–≤–∞—è)")
            print(f"‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–º–ø—Ç–æ–≤ _res.txt")
            print(f"‚úÖ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é")
            print(f"‚úÖ HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏")
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–≥—Ä–∞–º–º—ã
            charts_dir = pdf_generator.template_dir
            paei_charts = [
                charts_dir / "paei_bar.png",
                charts_dir / "paei_pie.png", 
                charts_dir / "paei_combined.png"
            ]
            
            print(f"\nüìä –°–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã PAEI:")
            for chart in paei_charts:
                if chart.exists():
                    size = chart.stat().st_size / 1024
                    print(f"‚úÖ {chart.name}: {size:.1f} KB")
                else:
                    print(f"‚ùå {chart.name}: –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
                    
            print(f"\nüéØ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –æ—Ç—á–µ—Ç –≥–æ—Ç–æ–≤!")
            print(f"üìÅ –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª: {result_path.absolute()}")
            
        else:
            print("‚ùå –û—à–∏–±–∫–∞: –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π PDF —Ñ–∞–π–ª –Ω–µ –±—ã–ª —Å–æ–∑–¥–∞–Ω")
            return False
            
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞: {e}")
        import traceback
        traceback.print_exc()
        return False
    
    return True

if __name__ == "__main__":
    print("üöÄ –ó–∞–ø—É—Å–∫ —Å–æ–∑–¥–∞–Ω–∏—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞...")
    
    success = create_demo_report()
    
    if success:
        print("\nüéâ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –æ—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!")
        print("\nüìã –ß—Ç–æ –Ω–æ–≤–æ–≥–æ:")
        print("‚Ä¢ –¢–µ—Å—Ç –ê–¥–∏–∑–µ—Å–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤—É–º—è –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏ —Ä—è–¥–æ–º")
        print("‚Ä¢ –°—Ç–æ–ª–±–∏–∫–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ (—Å–ª–µ–≤–∞) - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Ä–æ–≤–Ω–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Ç–∏–ø—É") 
        print("‚Ä¢ –ü–∏—Ä–æ–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ (—Å–ø—Ä–∞–≤–∞) - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –±–∞–ª–ª–æ–≤")
        print("‚Ä¢ –û–±–µ –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞–∑–º–µ—â–µ–Ω—ã –Ω–∞ –æ–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ –≤ PDF")
        print("‚Ä¢ –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö –∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤ _res.txt")
    else:
        print("\n‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞!")